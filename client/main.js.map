{"mappings":"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","sources":["./home/livid/github/other/markdown-preview-plus/node_modules/@parcel/scope-hoisting/lib/helpers.js","./lib-client/src-client/main.js","./lib-client/src-client/update-preview.js","./node_modules/morphdom/dist/morphdom-esm.js","./lib-client/src-client/diff.js","./lib-client/src-client/util.js","./lib-client/src-client/mathjax-helper.js","./lib-client/src/util-common.js"],"sourcesContent":[null,"import { ipcRenderer } from 'electron';\nimport { update } from './update-preview';\nimport { MathJaxController, processHTMLString } from './mathjax-helper';\nimport * as util from './util';\nimport { getMedia } from '../src/util-common';\nlet handlerId;\nlet nativePageScrollKeys = false;\nfunction uncaughtError(err) {\n    ipcRenderer.send('atom-markdown-preview-plus-ipc-uncaught-error', handlerId, {\n        message: err.message,\n        name: err.name,\n        stack: err.stack,\n    });\n}\nwindow.addEventListener('error', (e) => {\n    uncaughtError(e.error);\n});\nwindow.addEventListener('unhandledrejection', (evt) => {\n    uncaughtError(evt.reason);\n});\nfunction mkResPromise() {\n    let resFn;\n    const p = new Promise((resolve) => (resFn = resolve));\n    p.resolve = resFn;\n    return p;\n}\nconst atomVars = {\n    mathJax: mkResPromise(),\n    sourceLineMap: new Map(),\n    revSourceMap: new WeakMap(),\n};\nipcRenderer.on('set-id', (_evt, id) => {\n    handlerId = id;\n});\nipcRenderer.on('init', (_evt, params) => {\n    atomVars.mathJax.resolve(MathJaxController.create(params.userMacros, params.mathJaxConfig));\n    document.documentElement.dataset.markdownPreviewPlusContext = params.context;\n    if (params.context === 'pdf-export') {\n        document.documentElement.style.setProperty('width', `${params.pdfExportOptions.width}mm`, 'important');\n    }\n});\nipcRenderer.on('set-native-keys', (_evt, val) => {\n    nativePageScrollKeys = val;\n});\nfunction scrollSync({ firstLine, lastLine }) {\n    if (firstLine === 0) {\n        window.scroll({ top: 0 });\n        return;\n    }\n    const slm = atomVars.sourceLineMap;\n    const lines = Array.from(slm.keys()).sort((a, b) => a - b);\n    let lowix = lines.findIndex((x) => x >= firstLine);\n    if (lowix > 0)\n        lowix--;\n    let highix = lines.findIndex((x) => x >= lastLine);\n    if (highix === -1)\n        highix = lines.length - 1;\n    else if (highix < lines.length - 1)\n        highix++;\n    const low = lines[lowix];\n    const high = lines[highix];\n    let norm = 0;\n    let meanScroll = 0;\n    const entries = Array.from(slm.entries()).slice(lowix, highix + 1);\n    for (const [line, item] of entries) {\n        const weight = line <= (high + low) / 2 ? line - low + 1 : high - line + 1;\n        norm += weight;\n        meanScroll += item.getBoundingClientRect().top * weight;\n    }\n    if (norm === 0)\n        return;\n    const offset = document.documentElement.scrollTop;\n    const clientHeight = document.documentElement.clientHeight;\n    const top = offset - clientHeight / 2 + meanScroll / norm;\n    window.scroll({ top });\n}\nipcRenderer.on('scroll-sync', (_evt, params) => {\n    scrollSync(params);\n});\nipcRenderer.on('style', (_event, { styles }) => {\n    let styleElem = document.head.querySelector('style#atom-styles');\n    if (!styleElem) {\n        styleElem = document.createElement('style');\n        styleElem.id = 'atom-styles';\n        document.head.appendChild(styleElem);\n    }\n    styleElem.innerHTML = styles.join('\\n');\n});\nipcRenderer.on('update-images', (_event, { oldsrc, v }) => {\n    const imgs = getMedia(document);\n    for (const img of Array.from(imgs)) {\n        let ovs;\n        let ov;\n        let attrName;\n        if (img.tagName === 'LINK')\n            attrName = 'href';\n        else\n            attrName = 'src';\n        let src = img.getAttribute(attrName);\n        const match = src.match(/^(.*)\\?v=(\\d+)$/);\n        if (match)\n            [, src, ovs] = match;\n        if (src === oldsrc) {\n            if (ovs !== undefined)\n                ov = parseInt(ovs, 10);\n            if (v !== ov)\n                img[attrName] = v ? `${src}?v=${v}` : `${src}`;\n        }\n    }\n});\nipcRenderer.on('sync', (_event, { line, flash }) => {\n    const root = document.querySelector('div.update-preview');\n    if (!root)\n        return;\n    let element = atomVars.sourceLineMap.get(line);\n    if (!element) {\n        for (let i = line - 1; i >= 0; i -= 1) {\n            element = atomVars.sourceLineMap.get(line);\n            if (element)\n                break;\n        }\n    }\n    if (!element)\n        return;\n    element.scrollIntoViewIfNeeded(true);\n    if (flash) {\n        element.classList.add('flash');\n        setTimeout(() => element.classList.remove('flash'), 1000);\n    }\n});\nlet updatePromise;\nlet nextUpdateParams;\nasync function doUpdate({ id, html, renderLaTeX, map, diffMethod, scrollSyncParams, }) {\n    const preview = document.querySelector('div.update-preview');\n    if (!preview)\n        return;\n    const parser = new DOMParser();\n    const domDocument = parser.parseFromString(html, 'text/html');\n    const doc = document;\n    if (doc && domDocument.head.hasChildNodes) {\n        let container = doc.head.querySelector('original-elements');\n        if (!container) {\n            container = doc.createElement('original-elements');\n            doc.head.appendChild(container);\n        }\n        container.innerHTML = '';\n        for (const headElement of Array.from(domDocument.head.childNodes)) {\n            container.appendChild(headElement);\n        }\n    }\n    const visibleElements = scrollSyncParams\n        ? undefined\n        : Array.from(preview.children)\n            .map((x) => ({ el: x, r: x.getBoundingClientRect() }))\n            .filter(({ r }) => r.top <= window.innerHeight && r.bottom >= 0);\n    await update(preview, domDocument.body, {\n        renderLaTeX,\n        diffMethod,\n        mjController: await atomVars.mathJax,\n    });\n    if (visibleElements) {\n        const stillVisibleElements = visibleElements.filter(({ el }) => el.offsetParent);\n        const lastEl = stillVisibleElements[stillVisibleElements.length - 1];\n        if (lastEl) {\n            window.scrollBy({\n                top: lastEl.el.getBoundingClientRect().bottom - lastEl.r.bottom,\n            });\n        }\n    }\n    if (map) {\n        const slsm = new Map();\n        const rsm = new WeakMap();\n        for (const [lineS, path] of Object.entries(map)) {\n            const line = parseInt(lineS, 10);\n            const elem = util.resolveElement(preview, path);\n            if (elem) {\n                slsm.set(line, elem);\n                const rsmel = rsm.get(elem);\n                if (rsmel)\n                    rsmel.push(line);\n                else\n                    rsm.set(elem, [line]);\n            }\n        }\n        atomVars.sourceLineMap = slsm;\n        atomVars.revSourceMap = rsm;\n    }\n    if (scrollSyncParams)\n        scrollSync(scrollSyncParams);\n    ipcRenderer.send('atom-markdown-preview-plus-ipc-request-reply', handlerId, {\n        id,\n        request: 'update-preview',\n        result: processHTMLString(preview),\n    });\n}\nfunction delayedUpdate() {\n    let res;\n    if (nextUpdateParams)\n        res = doUpdate(nextUpdateParams).then(delayedUpdate);\n    nextUpdateParams = undefined;\n    return res;\n}\nipcRenderer.on('update-preview', (_event, params) => {\n    if (!updatePromise) {\n        updatePromise = doUpdate(params)\n            .then(delayedUpdate)\n            .catch(uncaughtError)\n            .then(() => {\n            updatePromise = undefined;\n        });\n    }\n    else {\n        nextUpdateParams = params;\n    }\n});\nipcRenderer.on('await-fully-ready', async (_event, { id }) => {\n    if (document.readyState === 'complete') {\n        ipcRenderer.send('atom-markdown-preview-plus-ipc-request-reply', handlerId, {\n            id,\n            request: 'await-fully-ready',\n            result: void 0,\n        });\n        return;\n    }\n    function loaded() {\n        ipcRenderer.send('atom-markdown-preview-plus-ipc-request-reply', handlerId, {\n            id,\n            request: 'await-fully-ready',\n            result: void 0,\n        });\n        document.removeEventListener('load', loaded);\n    }\n    document.addEventListener('load', loaded);\n});\nconst baseElement = document.createElement('base');\ndocument.head.appendChild(baseElement);\nipcRenderer.on('set-base-path', (_evt, { path }) => {\n    if (path)\n        baseElement.href = path;\n    else\n        baseElement.href = '';\n});\nipcRenderer.on('error', (_evt, { msg }) => {\n    const preview = document.querySelector('div.update-preview');\n    if (!preview)\n        return;\n    const errorDiv = document.createElement('div');\n    errorDiv.innerHTML = `<h2>Previewing Markdown Failed</h2><h3>${msg}</h3>`;\n    preview.appendChild(errorDiv);\n});\ndocument.addEventListener('wheel', (event) => {\n    if (event.ctrlKey) {\n        if (event.deltaY > 0) {\n            ipcRenderer.send('atom-markdown-preview-plus-ipc-zoom-in', handlerId);\n        }\n        else if (event.deltaY < 0) {\n            ipcRenderer.send('atom-markdown-preview-plus-ipc-zoom-out', handlerId);\n        }\n        event.preventDefault();\n        event.stopPropagation();\n    }\n});\ndocument.addEventListener('scroll', (_event) => {\n    const el = document.documentElement;\n    const height = el.clientHeight;\n    const visible = Array.from(atomVars.sourceLineMap.entries())\n        .filter(([_line, elem]) => {\n        const { top, bottom } = elem.getBoundingClientRect();\n        return top > 0 && bottom < height;\n    })\n        .map(([line, _elem]) => line);\n    ipcRenderer.send('atom-markdown-preview-plus-ipc-did-scroll-preview', handlerId, {\n        max: Math.max(...visible),\n        min: Math.min(...visible),\n    });\n});\nfunction keyEventHandler(type, e) {\n    if (nativePageScrollKeys &&\n        !e.altKey &&\n        !e.ctrlKey &&\n        !e.shiftKey &&\n        !e.metaKey &&\n        e.code.match(/^(Arrow.*|Page.*|Space|Home|End)$/)) {\n        return;\n    }\n    const data = {\n        type: type,\n        altKey: e.altKey,\n        ctrlKey: e.ctrlKey,\n        bubbles: e.bubbles,\n        cancelable: e.cancelable,\n        code: e.code,\n        composed: e.composed,\n        detail: e.detail,\n        isComposing: e.isComposing,\n        key: e.key,\n        location: e.location,\n        metaKey: e.metaKey,\n        repeat: e.repeat,\n        shiftKey: e.shiftKey,\n    };\n    ipcRenderer.send('atom-markdown-preview-plus-ipc-key', handlerId, data);\n    e.preventDefault();\n}\ndocument.addEventListener('keydown', keyEventHandler.bind(this, 'keydown'));\ndocument.addEventListener('keyup', keyEventHandler.bind(this, 'keyup'));\nlet lastContextMenuTarget;\ndocument.addEventListener('contextmenu', (e) => {\n    lastContextMenuTarget = e.target;\n    ipcRenderer.send('atom-markdown-preview-plus-ipc-show-context-menu', handlerId);\n});\nipcRenderer.on('sync-source', (_, { id }) => {\n    let element = lastContextMenuTarget;\n    const rsm = atomVars.revSourceMap;\n    let lines = rsm.get(element);\n    while (!lines && element.parentElement) {\n        element = element.parentElement;\n        lines = rsm.get(element);\n    }\n    if (!lines)\n        return;\n    ipcRenderer.send('atom-markdown-preview-plus-ipc-request-reply', handlerId, {\n        id,\n        request: 'sync-source',\n        result: Math.min(...lines),\n    });\n});\nipcRenderer.on('reload', (_, { id }) => {\n    window.onbeforeunload = null;\n    ipcRenderer.send('atom-markdown-preview-plus-ipc-request-reply', handlerId, {\n        id,\n        request: 'reload',\n        result: undefined,\n    });\n});\nwindow.onbeforeunload = function () {\n    return false;\n};\nipcRenderer.on('get-tex-config', async (_, { id }) => {\n    ipcRenderer.send('atom-markdown-preview-plus-ipc-request-reply', handlerId, {\n        id,\n        request: 'get-tex-config',\n        result: (await atomVars.mathJax).jaxTeXConfig(),\n    });\n});\nipcRenderer.on('get-selection', async (_, { id }) => {\n    const selection = window.getSelection();\n    const selectedText = selection && selection.toString();\n    const selectedNode = selection && selection.anchorNode;\n    ipcRenderer.send('atom-markdown-preview-plus-ipc-request-reply', handlerId, {\n        id,\n        request: 'get-selection',\n        result: selectedText && selectedNode ? selectedText : undefined,\n    });\n});\ndocument.addEventListener('click', (event) => {\n    if (!event.target)\n        return;\n    const el = event.target;\n    if (el.tagName === 'A') {\n        const href = el.getAttribute('href');\n        if (href && href.startsWith('#')) {\n            event.preventDefault();\n            const anchor = document.getElementById(decodeURIComponent(href).slice(1));\n            if (anchor)\n                anchor.scrollIntoView();\n        }\n    }\n});\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy1jbGllbnQvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sVUFBVSxDQUFBO0FBQ3RDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQTtBQUN6QyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQTtBQUN2RSxPQUFPLEtBQUssSUFBSSxNQUFNLFFBQVEsQ0FBQTtBQUM5QixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sb0JBQW9CLENBQUE7QUFHN0MsSUFBSSxTQUFpQixDQUFBO0FBQ3JCLElBQUksb0JBQW9CLEdBQUcsS0FBSyxDQUFBO0FBRWhDLFNBQVMsYUFBYSxDQUFDLEdBQVU7SUFDL0IsV0FBVyxDQUFDLElBQUksQ0FDZCwrQ0FBK0MsRUFDL0MsU0FBUyxFQUNUO1FBQ0UsT0FBTyxFQUFFLEdBQUcsQ0FBQyxPQUFPO1FBQ3BCLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSTtRQUNkLEtBQUssRUFBRSxHQUFHLENBQUMsS0FBSztLQUNqQixDQUNGLENBQUE7QUFDSCxDQUFDO0FBRUQsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFO0lBQ3JDLGFBQWEsQ0FBQyxDQUFDLENBQUMsS0FBYyxDQUFDLENBQUE7QUFDakMsQ0FBQyxDQUFDLENBQUE7QUFFRixNQUFNLENBQUMsZ0JBQWdCLENBQUMsb0JBQW9CLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRTtJQUNwRCxhQUFhLENBQUUsR0FBVyxDQUFDLE1BQWUsQ0FBQyxDQUFBO0FBQzdDLENBQUMsQ0FBQyxDQUFBO0FBRUYsU0FBUyxZQUFZO0lBQ25CLElBQUksS0FBdUQsQ0FBQTtJQUMzRCxNQUFNLENBQUMsR0FBRyxJQUFJLE9BQU8sQ0FBSSxDQUFDLE9BQU8sRUFB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Q0FBQTtZQUN0QixNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1lBQ3pFLElBQUksTUFBTTtnQkFBRSxNQUFNLENBQUMsY0FBYyxFQUFFLENBQUE7U0FDcEM7S0FDRjtBQUNILENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXBjUmVuZGVyZXIgfSBmcm9tICdlbGVjdHJvbidcbmltcG9ydCB7IHVwZGF0ZSB9IGZyb20gJy4vdXBkYXRlLXByZXZpZXcnXG5pbXBvcnQgeyBNYXRoSmF4Q29udHJvbGxlciwgcHJvY2Vzc0hUTUxTdHJpbmcgfSBmcm9tICcuL21hdGhqYXgtaGVscGVyJ1xuaW1wb3J0ICogYXMgdXRpbCBmcm9tICcuL3V0aWwnXG5pbXBvcnQgeyBnZXRNZWRpYSB9IGZyb20gJy4uL3NyYy91dGlsLWNvbW1vbidcbmltcG9ydCB7IENoYW5uZWxNYXAgfSBmcm9tICcuL2lwYydcblxubGV0IGhhbmRsZXJJZDogbnVtYmVyXG5sZXQgbmF0aXZlUGFnZVNjcm9sbEtleXMgPSBmYWxzZVxuXG5mdW5jdGlvbiB1bmNhdWdodEVycm9yKGVycjogRXJyb3IpIHtcbiAgaXBjUmVuZGVyZXIuc2VuZDwnYXRvbS1tYXJrZG93bi1wcmV2aWV3LXBsdXMtaXBjLXVuY2F1Z2h0LWVycm9yJz4oXG4gICAgJ2F0b20tbWFya2Rvd24tcHJldmlldy1wbHVzLWlwYy11bmNhdWdodC1lcnJvcicsXG4gICAgaGFuZGxlcklkLFxuICAgIHtcbiAgICAgIG1lc3NhZ2U6IGVyci5tZXNzYWdlLFxuICAgICAgbmFtZTogZXJyLm5hbWUsXG4gICAgICBzdGFjazogZXJyLnN0YWNrLFxuICAgIH0sXG4gIClcbn1cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKGUpID0+IHtcbiAgdW5jYXVnaHRFcnJvcihlLmVycm9yIGFzIEVycm9yKVxufSlcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3VuaGFuZGxlZHJlamVjdGlvbicsIChldnQpID0+IHtcbiAgdW5jYXVnaHRFcnJvcigoZXZ0IGFzIGFueSkucmVhc29uIGFzIEVycm9yKVxufSlcblxuZnVuY3Rpb24gbWtSZXNQcm9taXNlPFQ+KCkge1xuICBsZXQgcmVzRm46ICh2YWx1ZT86IFQgfCBQcm9taXNlTGlrZTxUPiB8IHVuZGVmaW5lZCkgPT4gdm9pZFxuICBjb25zdCBwID0gbmV3IFByb21pc2U8VD4oKHJlc29sdmUpID0+IChyZXNGbiA9IHJlc29sdmUpKSBhcyBQcm9taXNlPFQ+ICYge1xuICAgIHJlc29sdmU6IHR5cGVvZiByZXNGblxuICB9XG4gIHAucmVzb2x2ZSA9IHJlc0ZuIVxuICByZXR1cm4gcFxufVxuXG5jb25zdCBhdG9tVmFycyA9IHtcbiAgbWF0aEpheDogbWtSZXNQcm9taXNlPE1hdGhKYXhDb250cm9sbGVyPigpLFxuICBzb3VyY2VMaW5lTWFwOiBuZXcgTWFwPG51bWJlciwgRWxlbWVudD4oKSxcbiAgcmV2U291cmNlTWFwOiBuZXcgV2Vha01hcDxFbGVtZW50LCBudW1iZXJbXT4oKSxcbn1cblxuaXBjUmVuZGVyZXIub248J3NldC1pZCc+KCdzZXQtaWQnLCAoX2V2dCwgaWQpID0+IHtcbiAgaGFuZGxlcklkID0gaWRcbn0pXG5cbmlwY1JlbmRlcmVyLm9uPCdpbml0Jz4oJ2luaXQnLCAoX2V2dCwgcGFyYW1zKSA9PiB7XG4gIGF0b21WYXJzLm1hdGhKYXgucmVzb2x2ZShcbiAgICBNYXRoSmF4Q29udHJvbGxlci5jcmVhdGUocGFyYW1zLnVzZXJNYWNyb3MsIHBhcmFtcy5tYXRoSmF4Q29uZmlnKSxcbiAgKVxuICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQhLmRhdGFzZXQubWFya2Rvd25QcmV2aWV3UGx1c0NvbnRleHQgPSBwYXJhbXMuY29udGV4dFxuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dG90YWxpdHktY2hlY2tcbiAgaWYgKHBhcmFtcy5jb250ZXh0ID09PSAncGRmLWV4cG9ydCcpIHtcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQhLnN0eWxlLnNldFByb3BlcnR5KFxuICAgICAgJ3dpZHRoJyxcbiAgICAgIGAke3BhcmFtcy5wZGZFeHBvcnRPcHRpb25zLndpZHRofW1tYCxcbiAgICAgICdpbXBvcnRhbnQnLFxuICAgIClcbiAgfVxufSlcblxuaXBjUmVuZGVyZXIub248J3NldC1uYXRpdmUta2V5cyc+KCdzZXQtbmF0aXZlLWtleXMnLCAoX2V2dCwgdmFsKSA9PiB7XG4gIG5hdGl2ZVBhZ2VTY3JvbGxLZXlzID0gdmFsXG59KVxuXG5mdW5jdGlvbiBzY3JvbGxTeW5jKHsgZmlyc3RMaW5lLCBsYXN0TGluZSB9OiBDaGFubmVsTWFwWydzY3JvbGwtc3luYyddKSB7XG4gIGlmIChmaXJzdExpbmUgPT09IDApIHtcbiAgICB3aW5kb3cuc2Nyb2xsKHsgdG9wOiAwIH0pXG4gICAgcmV0dXJuXG4gIH1cbiAgY29uc3Qgc2xtID0gYXRvbVZhcnMuc291cmNlTGluZU1hcFxuICBjb25zdCBsaW5lcyA9IEFycmF5LmZyb20oc2xtLmtleXMoKSkuc29ydCgoYSwgYikgPT4gYSAtIGIpXG4gIGxldCBsb3dpeCA9IGxpbmVzLmZpbmRJbmRleCgoeCkgPT4geCA+PSBmaXJzdExpbmUpXG4gIGlmIChsb3dpeCA+IDApIGxvd2l4LS1cbiAgbGV0IGhpZ2hpeCA9IGxpbmVzLmZpbmRJbmRleCgoeCkgPT4geCA+PSBsYXN0TGluZSlcbiAgaWYgKGhpZ2hpeCA9PT0gLTEpIGhpZ2hpeCA9IGxpbmVzLmxlbmd0aCAtIDFcbiAgZWxzZSBpZiAoaGlnaGl4IDwgbGluZXMubGVuZ3RoIC0gMSkgaGlnaGl4KytcbiAgY29uc3QgbG93ID0gbGluZXNbbG93aXhdXG4gIGNvbnN0IGhpZ2ggPSBsaW5lc1toaWdoaXhdXG4gIGxldCBub3JtID0gMFxuICBsZXQgbWVhblNjcm9sbCA9IDBcbiAgY29uc3QgZW50cmllcyA9IEFycmF5LmZyb20oc2xtLmVudHJpZXMoKSkuc2xpY2UobG93aXgsIGhpZ2hpeCArIDEpXG4gIGZvciAoY29uc3QgW2xpbmUsIGl0ZW1dIG9mIGVudHJpZXMpIHtcbiAgICBjb25zdCB3ZWlnaHQgPSBsaW5lIDw9IChoaWdoICsgbG93KSAvIDIgPyBsaW5lIC0gbG93ICsgMSA6IGhpZ2ggLSBsaW5lICsgMVxuICAgIG5vcm0gKz0gd2VpZ2h0XG4gICAgbWVhblNjcm9sbCArPSBpdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCAqIHdlaWdodFxuICB9XG4gIGlmIChub3JtID09PSAwKSByZXR1cm5cbiAgY29uc3Qgb2Zmc2V0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IS5zY3JvbGxUb3BcbiAgY29uc3QgY2xpZW50SGVpZ2h0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IS5jbGllbnRIZWlnaHRcbiAgY29uc3QgdG9wID0gb2Zmc2V0IC0gY2xpZW50SGVpZ2h0IC8gMiArIG1lYW5TY3JvbGwgLyBub3JtXG4gIHdpbmRvdy5zY3JvbGwoeyB0b3AgfSlcbn1cblxuaXBjUmVuZGVyZXIub248J3Njcm9sbC1zeW5jJz4oJ3Njcm9sbC1zeW5jJywgKF9ldnQsIHBhcmFtcykgPT4ge1xuICBzY3JvbGxTeW5jKHBhcmFtcylcbn0pXG5cbmlwY1JlbmRlcmVyLm9uPCdzdHlsZSc+KCdzdHlsZScsIChfZXZlbnQsIHsgc3R5bGVzIH0pID0+IHtcbiAgbGV0IHN0eWxlRWxlbSA9IGRvY3VtZW50LmhlYWQhLnF1ZXJ5U2VsZWN0b3IoJ3N0eWxlI2F0b20tc3R5bGVzJylcbiAgaWYgKCFzdHlsZUVsZW0pIHtcbiAgICBzdHlsZUVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpXG4gICAgc3R5bGVFbGVtLmlkID0gJ2F0b20tc3R5bGVzJ1xuICAgIGRvY3VtZW50LmhlYWQhLmFwcGVuZENoaWxkKHN0eWxlRWxlbSlcbiAgfVxuICBzdHlsZUVsZW0uaW5uZXJIVE1MID0gc3R5bGVzLmpvaW4oJ1xcbicpXG59KVxuXG5pcGNSZW5kZXJlci5vbjwndXBkYXRlLWltYWdlcyc+KCd1cGRhdGUtaW1hZ2VzJywgKF9ldmVudCwgeyBvbGRzcmMsIHYgfSkgPT4ge1xuICBjb25zdCBpbWdzID0gZ2V0TWVkaWEoZG9jdW1lbnQpXG4gIGZvciAoY29uc3QgaW1nIG9mIEFycmF5LmZyb20oaW1ncykpIHtcbiAgICBsZXQgb3ZzOiBzdHJpbmcgfCB1bmRlZmluZWRcbiAgICBsZXQgb3Y6IG51bWJlciB8IHVuZGVmaW5lZFxuICAgIGxldCBhdHRyTmFtZTogJ2hyZWYnIHwgJ3NyYydcbiAgICBpZiAoaW1nLnRhZ05hbWUgPT09ICdMSU5LJykgYXR0ck5hbWUgPSAnaHJlZidcbiAgICBlbHNlIGF0dHJOYW1lID0gJ3NyYydcbiAgICBsZXQgc3JjID0gaW1nLmdldEF0dHJpYnV0ZShhdHRyTmFtZSkhXG4gICAgY29uc3QgbWF0Y2ggPSBzcmMubWF0Y2goL14oLiopXFw/dj0oXFxkKykkLylcbiAgICBpZiAobWF0Y2gpIFssIHNyYywgb3ZzXSA9IG1hdGNoXG4gICAgaWYgKHNyYyA9PT0gb2xkc3JjKSB7XG4gICAgICBpZiAob3ZzICE9PSB1bmRlZmluZWQpIG92ID0gcGFyc2VJbnQob3ZzLCAxMClcbiAgICAgIGlmICh2ICE9PSBvdikgaW1nW2F0dHJOYW1lXSA9IHYgPyBgJHtzcmN9P3Y9JHt2fWAgOiBgJHtzcmN9YFxuICAgIH1cbiAgfVxufSlcblxuaXBjUmVuZGVyZXIub248J3N5bmMnPignc3luYycsIChfZXZlbnQsIHsgbGluZSwgZmxhc2ggfSkgPT4ge1xuICBjb25zdCByb290ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LnVwZGF0ZS1wcmV2aWV3JylcbiAgaWYgKCFyb290KSByZXR1cm5cblxuICBsZXQgZWxlbWVudCA9IGF0b21WYXJzLnNvdXJjZUxpbmVNYXAuZ2V0KGxpbmUpXG5cbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgZm9yIChsZXQgaSA9IGxpbmUgLSAxOyBpID49IDA7IGkgLT0gMSkge1xuICAgICAgZWxlbWVudCA9IGF0b21WYXJzLnNvdXJjZUxpbmVNYXAuZ2V0KGxpbmUpXG4gICAgICBpZiAoZWxlbWVudCkgYnJlYWtcbiAgICB9XG4gIH1cblxuICBpZiAoIWVsZW1lbnQpIHJldHVyblxuXG4gIGVsZW1lbnQuc2Nyb2xsSW50b1ZpZXdJZk5lZWRlZCh0cnVlKVxuXG4gIGlmIChmbGFzaCkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZmxhc2gnKVxuICAgIHNldFRpbWVvdXQoKCkgPT4gZWxlbWVudCEuY2xhc3NMaXN0LnJlbW92ZSgnZmxhc2gnKSwgMTAwMClcbiAgfVxufSlcblxubGV0IHVwZGF0ZVByb21pc2U6IFByb21pc2U8dm9pZD4gfCB1bmRlZmluZWRcbmxldCBuZXh0VXBkYXRlUGFyYW1zOiBDaGFubmVsTWFwWyd1cGRhdGUtcHJldmlldyddIHwgdW5kZWZpbmVkXG5hc3luYyBmdW5jdGlvbiBkb1VwZGF0ZSh7XG4gIGlkLFxuICBodG1sLFxuICByZW5kZXJMYVRlWCxcbiAgbWFwLFxuICBkaWZmTWV0aG9kLFxuICBzY3JvbGxTeW5jUGFyYW1zLFxufTogQ2hhbm5lbE1hcFsndXBkYXRlLXByZXZpZXcnXSkge1xuICAvLyBkaXYudXBkYXRlLXByZXZpZXcgY3JlYXRlZCBhZnRlciBjb25zdHJ1Y3RvciBzdCBVcGRhdGVQcmV2aWV3IGNhbm5vdFxuICAvLyBiZSBpbnN0YW5jZWQgaW4gdGhlIGNvbnN0cnVjdG9yXG4gIGNvbnN0IHByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYudXBkYXRlLXByZXZpZXcnKVxuICBpZiAoIXByZXZpZXcpIHJldHVyblxuICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKClcbiAgY29uc3QgZG9tRG9jdW1lbnQgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKGh0bWwsICd0ZXh0L2h0bWwnKVxuICBjb25zdCBkb2MgPSBkb2N1bWVudFxuICBpZiAoZG9jICYmIGRvbURvY3VtZW50LmhlYWQhLmhhc0NoaWxkTm9kZXMpIHtcbiAgICBsZXQgY29udGFpbmVyID0gZG9jLmhlYWQhLnF1ZXJ5U2VsZWN0b3IoJ29yaWdpbmFsLWVsZW1lbnRzJylcbiAgICBpZiAoIWNvbnRhaW5lcikge1xuICAgICAgY29udGFpbmVyID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ29yaWdpbmFsLWVsZW1lbnRzJylcbiAgICAgIGRvYy5oZWFkIS5hcHBlbmRDaGlsZChjb250YWluZXIpXG4gICAgfVxuICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJ1xuICAgIGZvciAoY29uc3QgaGVhZEVsZW1lbnQgb2YgQXJyYXkuZnJvbShkb21Eb2N1bWVudC5oZWFkIS5jaGlsZE5vZGVzKSkge1xuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGhlYWRFbGVtZW50KVxuICAgIH1cbiAgfVxuICBjb25zdCB2aXNpYmxlRWxlbWVudHMgPSBzY3JvbGxTeW5jUGFyYW1zXG4gICAgPyB1bmRlZmluZWRcbiAgICA6IEFycmF5LmZyb20ocHJldmlldy5jaGlsZHJlbilcbiAgICAgICAgLm1hcCgoeCkgPT4gKHsgZWw6IHgsIHI6IHguZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgfSkpXG4gICAgICAgIC5maWx0ZXIoKHsgciB9KSA9PiByLnRvcCA8PSB3aW5kb3cuaW5uZXJIZWlnaHQgJiYgci5ib3R0b20gPj0gMClcbiAgYXdhaXQgdXBkYXRlKHByZXZpZXcsIGRvbURvY3VtZW50LmJvZHksIHtcbiAgICByZW5kZXJMYVRlWCxcbiAgICBkaWZmTWV0aG9kLFxuICAgIG1qQ29udHJvbGxlcjogYXdhaXQgYXRvbVZhcnMubWF0aEpheCxcbiAgfSlcbiAgaWYgKHZpc2libGVFbGVtZW50cykge1xuICAgIGNvbnN0IHN0aWxsVmlzaWJsZUVsZW1lbnRzID0gdmlzaWJsZUVsZW1lbnRzLmZpbHRlcihcbiAgICAgICh7IGVsIH0pID0+IChlbCBhcyBIVE1MRWxlbWVudCkub2Zmc2V0UGFyZW50LFxuICAgIClcbiAgICBjb25zdCBsYXN0RWwgPSBzdGlsbFZpc2libGVFbGVtZW50c1tzdGlsbFZpc2libGVFbGVtZW50cy5sZW5ndGggLSAxXVxuICAgIGlmIChsYXN0RWwpIHtcbiAgICAgIHdpbmRvdy5zY3JvbGxCeSh7XG4gICAgICAgIHRvcDogbGFzdEVsLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbSAtIGxhc3RFbC5yLmJvdHRvbSxcbiAgICAgIH0pXG4gICAgfVxuICB9XG4gIGlmIChtYXApIHtcbiAgICBjb25zdCBzbHNtID0gbmV3IE1hcDxudW1iZXIsIEVsZW1lbnQ+KClcbiAgICBjb25zdCByc20gPSBuZXcgV2Vha01hcDxFbGVtZW50LCBudW1iZXJbXT4oKVxuICAgIGZvciAoY29uc3QgW2xpbmVTLCBwYXRoXSBvZiBPYmplY3QuZW50cmllcyhtYXApKSB7XG4gICAgICBjb25zdCBsaW5lID0gcGFyc2VJbnQobGluZVMsIDEwKVxuICAgICAgY29uc3QgZWxlbSA9IHV0aWwucmVzb2x2ZUVsZW1lbnQocHJldmlldywgcGF0aClcbiAgICAgIGlmIChlbGVtKSB7XG4gICAgICAgIHNsc20uc2V0KGxpbmUsIGVsZW0pXG4gICAgICAgIGNvbnN0IHJzbWVsID0gcnNtLmdldChlbGVtKVxuICAgICAgICBpZiAocnNtZWwpIHJzbWVsLnB1c2gobGluZSlcbiAgICAgICAgZWxzZSByc20uc2V0KGVsZW0sIFtsaW5lXSlcbiAgICAgIH1cbiAgICB9XG4gICAgYXRvbVZhcnMuc291cmNlTGluZU1hcCA9IHNsc21cbiAgICBhdG9tVmFycy5yZXZTb3VyY2VNYXAgPSByc21cbiAgfVxuICBpZiAoc2Nyb2xsU3luY1BhcmFtcykgc2Nyb2xsU3luYyhzY3JvbGxTeW5jUGFyYW1zKVxuICBpcGNSZW5kZXJlci5zZW5kPCdhdG9tLW1hcmtkb3duLXByZXZpZXctcGx1cy1pcGMtcmVxdWVzdC1yZXBseSc+KFxuICAgICdhdG9tLW1hcmtkb3duLXByZXZpZXctcGx1cy1pcGMtcmVxdWVzdC1yZXBseScsXG4gICAgaGFuZGxlcklkLFxuICAgIHtcbiAgICAgIGlkLFxuICAgICAgcmVxdWVzdDogJ3VwZGF0ZS1wcmV2aWV3JyxcbiAgICAgIHJlc3VsdDogcHJvY2Vzc0hUTUxTdHJpbmcocHJldmlldyksXG4gICAgfSxcbiAgKVxufVxuXG5mdW5jdGlvbiBkZWxheWVkVXBkYXRlKCk6IFByb21pc2U8dm9pZD4gfCB1bmRlZmluZWQge1xuICBsZXQgcmVzXG4gIGlmIChuZXh0VXBkYXRlUGFyYW1zKSByZXMgPSBkb1VwZGF0ZShuZXh0VXBkYXRlUGFyYW1zKS50aGVuKGRlbGF5ZWRVcGRhdGUpXG4gIG5leHRVcGRhdGVQYXJhbXMgPSB1bmRlZmluZWRcbiAgcmV0dXJuIHJlc1xufVxuXG5pcGNSZW5kZXJlci5vbjwndXBkYXRlLXByZXZpZXcnPigndXBkYXRlLXByZXZpZXcnLCAoX2V2ZW50LCBwYXJhbXMpID0+IHtcbiAgaWYgKCF1cGRhdGVQcm9taXNlKSB7XG4gICAgdXBkYXRlUHJvbWlzZSA9IGRvVXBkYXRlKHBhcmFtcylcbiAgICAgIC50aGVuKGRlbGF5ZWRVcGRhdGUpXG4gICAgICAuY2F0Y2godW5jYXVnaHRFcnJvcilcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdXBkYXRlUHJvbWlzZSA9IHVuZGVmaW5lZFxuICAgICAgfSlcbiAgfSBlbHNlIHtcbiAgICBuZXh0VXBkYXRlUGFyYW1zID0gcGFyYW1zXG4gIH1cbn0pXG5cbmlwY1JlbmRlcmVyLm9uPCdhd2FpdC1mdWxseS1yZWFkeSc+KFxuICAnYXdhaXQtZnVsbHktcmVhZHknLFxuICBhc3luYyAoX2V2ZW50LCB7IGlkIH0pID0+IHtcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IHRvdGFsaXR5LWNoZWNrXG4gICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHtcbiAgICAgIGlwY1JlbmRlcmVyLnNlbmQ8J2F0b20tbWFya2Rvd24tcHJldmlldy1wbHVzLWlwYy1yZXF1ZXN0LXJlcGx5Jz4oXG4gICAgICAgICdhdG9tLW1hcmtkb3duLXByZXZpZXctcGx1cy1pcGMtcmVxdWVzdC1yZXBseScsXG4gICAgICAgIGhhbmRsZXJJZCxcbiAgICAgICAge1xuICAgICAgICAgIGlkLFxuICAgICAgICAgIHJlcXVlc3Q6ICdhd2FpdC1mdWxseS1yZWFkeScsXG4gICAgICAgICAgcmVzdWx0OiB2b2lkIDAsXG4gICAgICAgIH0sXG4gICAgICApXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgZnVuY3Rpb24gbG9hZGVkKCkge1xuICAgICAgaXBjUmVuZGVyZXIuc2VuZDwnYXRvbS1tYXJrZG93bi1wcmV2aWV3LXBsdXMtaXBjLXJlcXVlc3QtcmVwbHknPihcbiAgICAgICAgJ2F0b20tbWFya2Rvd24tcHJldmlldy1wbHVzLWlwYy1yZXF1ZXN0LXJlcGx5JyxcbiAgICAgICAgaGFuZGxlcklkLFxuICAgICAgICB7XG4gICAgICAgICAgaWQsXG4gICAgICAgICAgcmVxdWVzdDogJ2F3YWl0LWZ1bGx5LXJlYWR5JyxcbiAgICAgICAgICByZXN1bHQ6IHZvaWQgMCxcbiAgICAgICAgfSxcbiAgICAgIClcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBsb2FkZWQpXG4gICAgfVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBsb2FkZWQpXG4gIH0sXG4pXG5cbmNvbnN0IGJhc2VFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYmFzZScpXG5kb2N1bWVudC5oZWFkIS5hcHBlbmRDaGlsZChiYXNlRWxlbWVudClcblxuaXBjUmVuZGVyZXIub248J3NldC1iYXNlLXBhdGgnPignc2V0LWJhc2UtcGF0aCcsIChfZXZ0LCB7IHBhdGggfSkgPT4ge1xuICBpZiAocGF0aCkgYmFzZUVsZW1lbnQuaHJlZiA9IHBhdGhcbiAgZWxzZSBiYXNlRWxlbWVudC5ocmVmID0gJydcbn0pXG5cbmlwY1JlbmRlcmVyLm9uPCdlcnJvcic+KCdlcnJvcicsIChfZXZ0LCB7IG1zZyB9KSA9PiB7XG4gIGNvbnN0IHByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYudXBkYXRlLXByZXZpZXcnKVxuICBpZiAoIXByZXZpZXcpIHJldHVyblxuICBjb25zdCBlcnJvckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gIGVycm9yRGl2LmlubmVySFRNTCA9IGA8aDI+UHJldmlld2luZyBNYXJrZG93biBGYWlsZWQ8L2gyPjxoMz4ke21zZ308L2gzPmBcbiAgcHJldmlldy5hcHBlbmRDaGlsZChlcnJvckRpdilcbn0pXG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgKGV2ZW50KSA9PiB7XG4gIGlmIChldmVudC5jdHJsS2V5KSB7XG4gICAgaWYgKGV2ZW50LmRlbHRhWSA+IDApIHtcbiAgICAgIGlwY1JlbmRlcmVyLnNlbmQ8J2F0b20tbWFya2Rvd24tcHJldmlldy1wbHVzLWlwYy16b29tLWluJz4oXG4gICAgICAgICdhdG9tLW1hcmtkb3duLXByZXZpZXctcGx1cy1pcGMtem9vbS1pbicsXG4gICAgICAgIGhhbmRsZXJJZCxcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmRlbHRhWSA8IDApIHtcbiAgICAgIGlwY1JlbmRlcmVyLnNlbmQ8J2F0b20tbWFya2Rvd24tcHJldmlldy1wbHVzLWlwYy16b29tLW91dCc+KFxuICAgICAgICAnYXRvbS1tYXJrZG93bi1wcmV2aWV3LXBsdXMtaXBjLXpvb20tb3V0JyxcbiAgICAgICAgaGFuZGxlcklkLFxuICAgICAgKVxuICAgIH1cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcbiAgfVxufSlcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgKF9ldmVudCkgPT4ge1xuICBjb25zdCBlbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCFcbiAgY29uc3QgaGVpZ2h0ID0gZWwuY2xpZW50SGVpZ2h0XG4gIGNvbnN0IHZpc2libGUgPSBBcnJheS5mcm9tKGF0b21WYXJzLnNvdXJjZUxpbmVNYXAuZW50cmllcygpKVxuICAgIC5maWx0ZXIoKFtfbGluZSwgZWxlbV0pID0+IHtcbiAgICAgIGNvbnN0IHsgdG9wLCBib3R0b20gfSA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgIHJldHVybiB0b3AgPiAwICYmIGJvdHRvbSA8IGhlaWdodFxuICAgIH0pXG4gICAgLm1hcCgoW2xpbmUsIF9lbGVtXSkgPT4gbGluZSlcbiAgaXBjUmVuZGVyZXIuc2VuZDwnYXRvbS1tYXJrZG93bi1wcmV2aWV3LXBsdXMtaXBjLWRpZC1zY3JvbGwtcHJldmlldyc+KFxuICAgICdhdG9tLW1hcmtkb3duLXByZXZpZXctcGx1cy1pcGMtZGlkLXNjcm9sbC1wcmV2aWV3JyxcbiAgICBoYW5kbGVySWQsXG4gICAge1xuICAgICAgbWF4OiBNYXRoLm1heCguLi52aXNpYmxlKSxcbiAgICAgIG1pbjogTWF0aC5taW4oLi4udmlzaWJsZSksXG4gICAgfSxcbiAgKVxufSlcblxuZnVuY3Rpb24ga2V5RXZlbnRIYW5kbGVyKHR5cGU6ICdrZXlkb3duJyB8ICdrZXl1cCcsIGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgaWYgKFxuICAgIG5hdGl2ZVBhZ2VTY3JvbGxLZXlzICYmXG4gICAgIWUuYWx0S2V5ICYmXG4gICAgIWUuY3RybEtleSAmJlxuICAgICFlLnNoaWZ0S2V5ICYmXG4gICAgIWUubWV0YUtleSAmJlxuICAgIGUuY29kZS5tYXRjaCgvXihBcnJvdy4qfFBhZ2UuKnxTcGFjZXxIb21lfEVuZCkkLylcbiAgKSB7XG4gICAgcmV0dXJuXG4gIH1cbiAgY29uc3QgZGF0YSA9IHtcbiAgICB0eXBlOiB0eXBlLFxuICAgIGFsdEtleTogZS5hbHRLZXksXG4gICAgY3RybEtleTogZS5jdHJsS2V5LFxuICAgIGJ1YmJsZXM6IGUuYnViYmxlcyxcbiAgICBjYW5jZWxhYmxlOiBlLmNhbmNlbGFibGUsXG4gICAgY29kZTogZS5jb2RlLFxuICAgIGNvbXBvc2VkOiBlLmNvbXBvc2VkLFxuICAgIGRldGFpbDogZS5kZXRhaWwsXG4gICAgaXNDb21wb3Npbmc6IGUuaXNDb21wb3NpbmcsXG4gICAga2V5OiBlLmtleSxcbiAgICBsb2NhdGlvbjogZS5sb2NhdGlvbixcbiAgICBtZXRhS2V5OiBlLm1ldGFLZXksXG4gICAgcmVwZWF0OiBlLnJlcGVhdCxcbiAgICBzaGlmdEtleTogZS5zaGlmdEtleSxcbiAgfSBhcyBjb25zdFxuICBpcGNSZW5kZXJlci5zZW5kPCdhdG9tLW1hcmtkb3duLXByZXZpZXctcGx1cy1pcGMta2V5Jz4oXG4gICAgJ2F0b20tbWFya2Rvd24tcHJldmlldy1wbHVzLWlwYy1rZXknLFxuICAgIGhhbmRsZXJJZCxcbiAgICBkYXRhLFxuICApXG4gIGUucHJldmVudERlZmF1bHQoKVxufVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5RXZlbnRIYW5kbGVyLmJpbmQodGhpcywgJ2tleWRvd24nKSlcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywga2V5RXZlbnRIYW5kbGVyLmJpbmQodGhpcywgJ2tleXVwJykpXG5cbmxldCBsYXN0Q29udGV4dE1lbnVUYXJnZXQ6IEhUTUxFbGVtZW50XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIChlKSA9PiB7XG4gIGxhc3RDb250ZXh0TWVudVRhcmdldCA9IGUudGFyZ2V0IGFzIEhUTUxFbGVtZW50XG4gIGlwY1JlbmRlcmVyLnNlbmQ8J2F0b20tbWFya2Rvd24tcHJldmlldy1wbHVzLWlwYy1zaG93LWNvbnRleHQtbWVudSc+KFxuICAgICdhdG9tLW1hcmtkb3duLXByZXZpZXctcGx1cy1pcGMtc2hvdy1jb250ZXh0LW1lbnUnLFxuICAgIGhhbmRsZXJJZCxcbiAgKVxufSlcblxuaXBjUmVuZGVyZXIub248J3N5bmMtc291cmNlJz4oJ3N5bmMtc291cmNlJywgKF8sIHsgaWQgfSkgPT4ge1xuICBsZXQgZWxlbWVudCA9IGxhc3RDb250ZXh0TWVudVRhcmdldFxuICBjb25zdCByc20gPSBhdG9tVmFycy5yZXZTb3VyY2VNYXBcbiAgbGV0IGxpbmVzID0gcnNtLmdldChlbGVtZW50KVxuXG4gIHdoaWxlICghbGluZXMgJiYgZWxlbWVudC5wYXJlbnRFbGVtZW50KSB7XG4gICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudFxuICAgIGxpbmVzID0gcnNtLmdldChlbGVtZW50KVxuICB9XG4gIGlmICghbGluZXMpIHJldHVyblxuXG4gIGlwY1JlbmRlcmVyLnNlbmQ8J2F0b20tbWFya2Rvd24tcHJldmlldy1wbHVzLWlwYy1yZXF1ZXN0LXJlcGx5Jz4oXG4gICAgJ2F0b20tbWFya2Rvd24tcHJldmlldy1wbHVzLWlwYy1yZXF1ZXN0LXJlcGx5JyxcbiAgICBoYW5kbGVySWQsXG4gICAge1xuICAgICAgaWQsXG4gICAgICByZXF1ZXN0OiAnc3luYy1zb3VyY2UnLFxuICAgICAgcmVzdWx0OiBNYXRoLm1pbiguLi5saW5lcyksXG4gICAgfSxcbiAgKVxufSlcblxuaXBjUmVuZGVyZXIub248J3JlbG9hZCc+KCdyZWxvYWQnLCAoXywgeyBpZCB9KSA9PiB7XG4gIHdpbmRvdy5vbmJlZm9yZXVubG9hZCA9IG51bGxcbiAgaXBjUmVuZGVyZXIuc2VuZDwnYXRvbS1tYXJrZG93bi1wcmV2aWV3LXBsdXMtaXBjLXJlcXVlc3QtcmVwbHknPihcbiAgICAnYXRvbS1tYXJrZG93bi1wcmV2aWV3LXBsdXMtaXBjLXJlcXVlc3QtcmVwbHknLFxuICAgIGhhbmRsZXJJZCxcbiAgICB7XG4gICAgICBpZCxcbiAgICAgIHJlcXVlc3Q6ICdyZWxvYWQnLFxuICAgICAgcmVzdWx0OiB1bmRlZmluZWQsXG4gICAgfSxcbiAgKVxufSlcblxud2luZG93Lm9uYmVmb3JldW5sb2FkID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZmFsc2Vcbn1cblxuaXBjUmVuZGVyZXIub248J2dldC10ZXgtY29uZmlnJz4oJ2dldC10ZXgtY29uZmlnJywgYXN5bmMgKF8sIHsgaWQgfSkgPT4ge1xuICBpcGNSZW5kZXJlci5zZW5kPCdhdG9tLW1hcmtkb3duLXByZXZpZXctcGx1cy1pcGMtcmVxdWVzdC1yZXBseSc+KFxuICAgICdhdG9tLW1hcmtkb3duLXByZXZpZXctcGx1cy1pcGMtcmVxdWVzdC1yZXBseScsXG4gICAgaGFuZGxlcklkLFxuICAgIHtcbiAgICAgIGlkLFxuICAgICAgcmVxdWVzdDogJ2dldC10ZXgtY29uZmlnJyxcbiAgICAgIHJlc3VsdDogKGF3YWl0IGF0b21WYXJzLm1hdGhKYXgpLmpheFRlWENvbmZpZygpLFxuICAgIH0sXG4gIClcbn0pXG5cbmlwY1JlbmRlcmVyLm9uPCdnZXQtc2VsZWN0aW9uJz4oJ2dldC1zZWxlY3Rpb24nLCBhc3luYyAoXywgeyBpZCB9KSA9PiB7XG4gIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKVxuICBjb25zdCBzZWxlY3RlZFRleHQgPSBzZWxlY3Rpb24gJiYgc2VsZWN0aW9uLnRvU3RyaW5nKClcbiAgY29uc3Qgc2VsZWN0ZWROb2RlID0gc2VsZWN0aW9uICYmIHNlbGVjdGlvbi5hbmNob3JOb2RlXG5cbiAgaXBjUmVuZGVyZXIuc2VuZDwnYXRvbS1tYXJrZG93bi1wcmV2aWV3LXBsdXMtaXBjLXJlcXVlc3QtcmVwbHknPihcbiAgICAnYXRvbS1tYXJrZG93bi1wcmV2aWV3LXBsdXMtaXBjLXJlcXVlc3QtcmVwbHknLFxuICAgIGhhbmRsZXJJZCxcbiAgICB7XG4gICAgICBpZCxcbiAgICAgIHJlcXVlc3Q6ICdnZXQtc2VsZWN0aW9uJyxcbiAgICAgIHJlc3VsdDogc2VsZWN0ZWRUZXh0ICYmIHNlbGVjdGVkTm9kZSA/IHNlbGVjdGVkVGV4dCA6IHVuZGVmaW5lZCxcbiAgICB9LFxuICApXG59KVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICBpZiAoIWV2ZW50LnRhcmdldCkgcmV0dXJuXG4gIGNvbnN0IGVsID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50XG4gIGlmIChlbC50YWdOYW1lID09PSAnQScpIHtcbiAgICBjb25zdCBocmVmID0gZWwuZ2V0QXR0cmlidXRlKCdocmVmJylcbiAgICBpZiAoaHJlZiAmJiBocmVmLnN0YXJ0c1dpdGgoJyMnKSkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgY29uc3QgYW5jaG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGVjb2RlVVJJQ29tcG9uZW50KGhyZWYpLnNsaWNlKDEpKVxuICAgICAgaWYgKGFuY2hvcikgYW5jaG9yLnNjcm9sbEludG9WaWV3KClcbiAgICB9XG4gIH1cbn0pXG4iXX0=","import morph from 'morphdom';\nimport { diff } from './diff';\nfunction isEqualMath(a, b) {\n    const tcs = getMathContents(a, b);\n    return tcs && tcs[0].textContent === tcs[1].textContent;\n}\nfunction getMathContents(a, b) {\n    if (!isElement(a) || !isElement(b))\n        return false;\n    if (a.tagName !== 'SPAN' ||\n        b.tagName !== 'SPAN' ||\n        !a.classList.contains('math') ||\n        !b.classList.contains('math')) {\n        return false;\n    }\n    const ascr = a.querySelector(':scope > script');\n    if (!ascr)\n        return false;\n    const bscr = b.querySelector(':scope > script');\n    if (!bscr)\n        return false;\n    if (ascr.type !== bscr.type)\n        return false;\n    return [ascr, bscr];\n}\nfunction isElement(a) {\n    return a.nodeType === Node.ELEMENT_NODE;\n}\nfunction checkDocumentType(a, b) {\n    return (a.name === b.name && a.publicId === b.publicId && a.systemId === b.systemId);\n}\nfunction checkElement(a, b) {\n    if (a.attributes.length !== b.attributes.length)\n        return false;\n    return Array.from(a.attributes).every((x) => x.isEqualNode(b.attributes.getNamedItemNS(x.namespaceURI, x.localName)));\n}\nfunction checkAttr(a, b) {\n    return (a.namespaceURI === b.namespaceURI &&\n        a.localName === b.localName &&\n        a.value === b.value);\n}\nfunction checkProcInstr(a, b) {\n    return a.target === b.target && a.data === b.data;\n}\nfunction checkData(a, b) {\n    return a.data === b.data;\n}\nfunction isEqual(a, b) {\n    if (a.isEqualNode(b))\n        return true;\n    if (isEqualMath(a, b))\n        return true;\n    if (a.nodeType !== b.nodeType)\n        return false;\n    if (a.childNodes.length !== b.childNodes.length)\n        return false;\n    let ac = a.firstChild;\n    let bc = b.firstChild;\n    while (ac && bc) {\n        if (!isEqual(ac, bc))\n            return false;\n        ac = ac.nextSibling;\n        bc = bc.nextSibling;\n    }\n    switch (a.nodeType) {\n        case Node.DOCUMENT_TYPE_NODE:\n            return checkDocumentType(a, b);\n        case Node.ELEMENT_NODE:\n            return checkElement(a, b);\n        case Node.ATTRIBUTE_NODE:\n            return checkAttr(a, b);\n        case Node.PROCESSING_INSTRUCTION_NODE:\n            return checkProcInstr(a, b);\n        case Node.TEXT_NODE:\n        case Node.COMMENT_NODE:\n            return checkData(a, b);\n        default:\n            return true;\n    }\n}\nfunction* allChildren(node) {\n    for (const c of node.children) {\n        if (c.tagName === 'SPAN' && c.classList.contains('MathJax'))\n            continue;\n        if (c.tagName === 'SPAN' && c.classList.contains('MathJax_SVG'))\n            continue;\n        if (c.tagName === 'SCRIPT')\n            continue;\n        if (c.tagName === 'DIV' && c.classList.contains('MathJax_Display'))\n            continue;\n        if (c.tagName === 'DIV' && c.classList.contains('MathJax_SVG_Display')) {\n            continue;\n        }\n        yield c;\n        yield* allChildren(c);\n    }\n}\nfunction runHeuristic(idMap, newDom, oldDom) {\n    let idx = 0;\n    function matchEls(newRoot, oldRoot) {\n        let newEl = newRoot.firstChild;\n        let oldEl = oldRoot.firstChild;\n        const newCount = newRoot.childNodes.length;\n        const oldCount = oldRoot.childNodes.length;\n        if (newCount > oldCount) {\n            while (oldEl && newEl) {\n                if (isEqual(newEl, oldEl)) {\n                    if (newEl.nodeType === Node.ELEMENT_NODE) {\n                        const sidx = idx.toString(36);\n                        idMap.set(oldEl, sidx);\n                        idMap.set(newEl, sidx);\n                        idx++;\n                    }\n                    matchEls(newEl, oldEl);\n                    oldEl = oldEl.nextSibling;\n                }\n                newEl = newEl.nextSibling;\n            }\n        }\n        else if (newCount < oldCount) {\n            while (oldEl && newEl) {\n                if (isEqual(newEl, oldEl)) {\n                    if (newEl.nodeType === Node.ELEMENT_NODE) {\n                        const sidx = idx.toString(36);\n                        idMap.set(oldEl, sidx);\n                        idMap.set(newEl, sidx);\n                        idx++;\n                    }\n                    matchEls(newEl, oldEl);\n                    newEl = newEl.nextSibling;\n                }\n                oldEl = oldEl.nextSibling;\n            }\n        }\n    }\n    matchEls(newDom, oldDom);\n}\nfunction time(cb) {\n    const start = performance.now();\n    const res = cb();\n    console.log(cb.toString(), performance.now() - start, 'ms');\n    return res;\n}\nexport async function update(oldDom, newDom, opts) {\n    const idMap = new WeakMap();\n    switch (opts.diffMethod) {\n        case 'heuristic': {\n            time(() => runHeuristic(idMap, newDom, oldDom));\n            break;\n        }\n        case 'myers': {\n            const a = time(() => Array.from(allChildren(oldDom)));\n            const b = time(() => Array.from(allChildren(newDom)));\n            let ncomp = 0;\n            let idx = 0;\n            time(() => diff(a, b, (a, b) => {\n                ncomp++;\n                return isEqual(a, b);\n            }, (pairs) => {\n                for (const [x, y] of pairs) {\n                    const sidx = idx.toString(36);\n                    idMap.set(x, sidx);\n                    idMap.set(y, sidx);\n                    idx++;\n                }\n            }));\n            console.log('a:', a.length, 'b:', b.length, 'comp:', ncomp);\n            break;\n        }\n        case 'none':\n            break;\n    }\n    try {\n        morph(oldDom, newDom, {\n            childrenOnly: true,\n            onBeforeElUpdated(fromEl, toEl) {\n                if (fromEl.isEqualNode(toEl))\n                    return false;\n                const tcs = getMathContents(fromEl, toEl);\n                if (tcs) {\n                    if (tcs[0].textContent !== tcs[1].textContent) {\n                        tcs[0].textContent = tcs[1].textContent;\n                    }\n                    return false;\n                }\n                return true;\n            },\n            getNodeKey(node) {\n                return idMap.get(node) || '';\n            },\n        });\n    }\n    catch (e) {\n        console.error(e);\n        oldDom.innerHTML = newDom.innerHTML;\n    }\n    if (opts.renderLaTeX)\n        await opts.mjController.queueTypeset(oldDom);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXBkYXRlLXByZXZpZXcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMtY2xpZW50L3VwZGF0ZS1wcmV2aWV3LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxNQUFNLFVBQVUsQ0FBQTtBQUU1QixPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sUUFBUSxDQUFBO0FBRzdCLFNBQVMsV0FBVyxDQUFDLENBQU8sRUFBRSxDQUFPO0lBQ25DLE1BQU0sR0FBRyxHQUFHLGVBQWUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7SUFDakMsT0FBTyxHQUFHLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFBO0FBQ3pELENBQUM7QUFFRCxTQUFTLGVBQWUsQ0FBQyxDQUFPLEVBQUUsQ0FBTztJQUN2QyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUFFLE9BQU8sS0FBSyxDQUFBO0lBQ2hELElBQ0UsQ0FBQyxDQUFDLE9BQU8sS0FBSyxNQUFNO1FBQ3BCLENBQUMsQ0FBQyxPQUFPLEtBQUssTUFBTTtRQUNwQixDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQztRQUM3QixDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUM3QjtRQUNBLE9BQU8sS0FBSyxDQUFBO0tBQ2I7SUFDRCxNQUFNLElBQUksR0FBRyxDQUFDLENBQUMsYUFBYSxDQUFvQixpQkFBaUIsQ0FBQyxDQUFBO0lBQ2xFLElBQUksQ0FBQyxJQUFJO1FBQUUsT0FBTyxLQUFLLENBQUE7SUFDdkIsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDLGFBQWEsQ0FBb0IsaUJBQWlCLENBQUMsQ0FBQTtJQUNsRSxJQUFJLENBQUMsSUFBSTtRQUFFLE9BQU8sS0FBSyxDQUFBO0lBQ3ZCLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsSUFBSTtRQUFFLE9BQU8sS0FBSyxDQUFBO0lBQ3pDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFVLENBQUE7QUFDOUIsQ0FBQztBQUVELFNBQVMsU0FBUyxDQUFDLENBQU87SUFDeEIsT0FBTyxDQUFDLENBQUMsUUFBUSxLQUFLLElBQUksQ0FBQyxZQUFZLENBQUE7QUFDekMsQ0FBQztBQUVELFNBQVMsaUJBQWlCLENBQUMsQ0FBZSxFQUFFLENBQWU7SUFDekQsT0FBTyxDQUNMLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsUUFBUSxLQUFLLENBQUMsQ0FBQyxRQUFRLElBQUksQ0FBQyxDQUFDLFFBQVEsS0FBSyxDQUFDLENBQUMsUUFBUSxDQUM1RSxDQUFBO0FBQ0gsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLENBQVUsRUFBRSxDQUFVO0lBQzFDLElBQUksQ0FBQyxDQUFDLFVBQVUsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLFVBQVUsQ0FBQyxNQUFNO1FBQUUsT0FBTyxLQUFLLENBQUE7SUFDN0QsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUMxQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQ3hFLENBQUE7QUFDSCxDQUFDO0FBRUQsU0FBUyxTQUFTLENBQUMsQ0FBTyxFQUFFLENBQU87SUFDakMsT0FBTyxDQUNMLENBQUMsQ0FBQyxZQUFZLEtBQUssQ0FBQyxDQUFDLFlBQVk7UUFDakMsQ0FBQyxDQUFDLFNBQVMsS0FBSyxDQUFDLENBQUMsU0FBUztRQUMzQixDQUFDLENBQUMsS0FBSyxLQUFLLENBQUMsQ0FBQyxL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dGVudCI6WyJpbXBvcnQgbW9ycGggZnJvbSAnbW9ycGhkb20nXG5pbXBvcnQgeyBNYXRoSmF4Q29udHJvbGxlciB9IGZyb20gJy4vbWF0aGpheC1oZWxwZXInXG5pbXBvcnQgeyBkaWZmIH0gZnJvbSAnLi9kaWZmJ1xuaW1wb3J0IHsgVERpZmZNZXRob2QgfSBmcm9tICcuL2lwYydcblxuZnVuY3Rpb24gaXNFcXVhbE1hdGgoYTogTm9kZSwgYjogTm9kZSkge1xuICBjb25zdCB0Y3MgPSBnZXRNYXRoQ29udGVudHMoYSwgYilcbiAgcmV0dXJuIHRjcyAmJiB0Y3NbMF0udGV4dENvbnRlbnQgPT09IHRjc1sxXS50ZXh0Q29udGVudFxufVxuXG5mdW5jdGlvbiBnZXRNYXRoQ29udGVudHMoYTogTm9kZSwgYjogTm9kZSkge1xuICBpZiAoIWlzRWxlbWVudChhKSB8fCAhaXNFbGVtZW50KGIpKSByZXR1cm4gZmFsc2VcbiAgaWYgKFxuICAgIGEudGFnTmFtZSAhPT0gJ1NQQU4nIHx8XG4gICAgYi50YWdOYW1lICE9PSAnU1BBTicgfHxcbiAgICAhYS5jbGFzc0xpc3QuY29udGFpbnMoJ21hdGgnKSB8fFxuICAgICFiLmNsYXNzTGlzdC5jb250YWlucygnbWF0aCcpXG4gICkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIGNvbnN0IGFzY3IgPSBhLnF1ZXJ5U2VsZWN0b3I8SFRNTFNjcmlwdEVsZW1lbnQ+KCc6c2NvcGUgPiBzY3JpcHQnKVxuICBpZiAoIWFzY3IpIHJldHVybiBmYWxzZVxuICBjb25zdCBic2NyID0gYi5xdWVyeVNlbGVjdG9yPEhUTUxTY3JpcHRFbGVtZW50PignOnNjb3BlID4gc2NyaXB0JylcbiAgaWYgKCFic2NyKSByZXR1cm4gZmFsc2VcbiAgaWYgKGFzY3IudHlwZSAhPT0gYnNjci50eXBlKSByZXR1cm4gZmFsc2VcbiAgcmV0dXJuIFthc2NyLCBic2NyXSBhcyBjb25zdFxufVxuXG5mdW5jdGlvbiBpc0VsZW1lbnQoYTogTm9kZSk6IGEgaXMgRWxlbWVudCB7XG4gIHJldHVybiBhLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERVxufVxuXG5mdW5jdGlvbiBjaGVja0RvY3VtZW50VHlwZShhOiBEb2N1bWVudFR5cGUsIGI6IERvY3VtZW50VHlwZSkge1xuICByZXR1cm4gKFxuICAgIGEubmFtZSA9PT0gYi5uYW1lICYmIGEucHVibGljSWQgPT09IGIucHVibGljSWQgJiYgYS5zeXN0ZW1JZCA9PT0gYi5zeXN0ZW1JZFxuICApXG59XG5cbmZ1bmN0aW9uIGNoZWNrRWxlbWVudChhOiBFbGVtZW50LCBiOiBFbGVtZW50KSB7XG4gIGlmIChhLmF0dHJpYnV0ZXMubGVuZ3RoICE9PSBiLmF0dHJpYnV0ZXMubGVuZ3RoKSByZXR1cm4gZmFsc2VcbiAgcmV0dXJuIEFycmF5LmZyb20oYS5hdHRyaWJ1dGVzKS5ldmVyeSgoeCkgPT5cbiAgICB4LmlzRXF1YWxOb2RlKGIuYXR0cmlidXRlcy5nZXROYW1lZEl0ZW1OUyh4Lm5hbWVzcGFjZVVSSSwgeC5sb2NhbE5hbWUpKSxcbiAgKVxufVxuXG5mdW5jdGlvbiBjaGVja0F0dHIoYTogQXR0ciwgYjogQXR0cikge1xuICByZXR1cm4gKFxuICAgIGEubmFtZXNwYWNlVVJJID09PSBiLm5hbWVzcGFjZVVSSSAmJlxuICAgIGEubG9jYWxOYW1lID09PSBiLmxvY2FsTmFtZSAmJlxuICAgIGEudmFsdWUgPT09IGIudmFsdWVcbiAgKVxufVxuXG5mdW5jdGlvbiBjaGVja1Byb2NJbnN0cihhOiBQcm9jZXNzaW5nSW5zdHJ1Y3Rpb24sIGI6IFByb2Nlc3NpbmdJbnN0cnVjdGlvbikge1xuICByZXR1cm4gYS50YXJnZXQgPT09IGIudGFyZ2V0ICYmIGEuZGF0YSA9PT0gYi5kYXRhXG59XG5cbmZ1bmN0aW9uIGNoZWNrRGF0YShhOiB7IGRhdGE6IHN0cmluZyB9LCBiOiB7IGRhdGE6IHN0cmluZyB9KSB7XG4gIHJldHVybiBhLmRhdGEgPT09IGIuZGF0YVxufVxuXG4vLyBiYXNlZCBvbiBodHRwczovL2RvbS5zcGVjLndoYXR3Zy5vcmcvI2NvbmNlcHQtbm9kZS1lcXVhbHNcbmZ1bmN0aW9uIGlzRXF1YWwoYTogTm9kZSwgYjogTm9kZSk6IGJvb2xlYW4ge1xuICAvLyBlYXJseSBiYWlsb3V0c1xuICBpZiAoYS5pc0VxdWFsTm9kZShiKSkgcmV0dXJuIHRydWVcbiAgaWYgKGlzRXF1YWxNYXRoKGEsIGIpKSByZXR1cm4gdHJ1ZVxuXG4gIC8vIG5vZGUgY2hlY2tzXG4gIGlmIChhLm5vZGVUeXBlICE9PSBiLm5vZGVUeXBlKSByZXR1cm4gZmFsc2VcbiAgaWYgKGEuY2hpbGROb2Rlcy5sZW5ndGggIT09IGIuY2hpbGROb2Rlcy5sZW5ndGgpIHJldHVybiBmYWxzZVxuXG4gIC8vIHJlY3Vyc2l2ZWx5IGNoZWNrIGNoaWxkcmVuXG4gIGxldCBhYyA9IGEuZmlyc3RDaGlsZFxuICBsZXQgYmMgPSBiLmZpcnN0Q2hpbGRcbiAgd2hpbGUgKGFjICYmIGJjKSB7XG4gICAgaWYgKCFpc0VxdWFsKGFjLCBiYykpIHJldHVybiBmYWxzZVxuICAgIGFjID0gYWMubmV4dFNpYmxpbmdcbiAgICBiYyA9IGJjLm5leHRTaWJsaW5nXG4gIH1cblxuICBzd2l0Y2ggKGEubm9kZVR5cGUpIHtcbiAgICBjYXNlIE5vZGUuRE9DVU1FTlRfVFlQRV9OT0RFOlxuICAgICAgcmV0dXJuIGNoZWNrRG9jdW1lbnRUeXBlKGEgYXMgRG9jdW1lbnRUeXBlLCBiIGFzIERvY3VtZW50VHlwZSlcbiAgICBjYXNlIE5vZGUuRUxFTUVOVF9OT0RFOlxuICAgICAgcmV0dXJuIGNoZWNrRWxlbWVudChhIGFzIEVsZW1lbnQsIGIgYXMgRWxlbWVudClcbiAgICBjYXNlIE5vZGUuQVRUUklCVVRFX05PREU6XG4gICAgICByZXR1cm4gY2hlY2tBdHRyKGEgYXMgQXR0ciwgYiBhcyBBdHRyKVxuICAgIGNhc2UgTm9kZS5QUk9DRVNTSU5HX0lOU1RSVUNUSU9OX05PREU6XG4gICAgICByZXR1cm4gY2hlY2tQcm9jSW5zdHIoXG4gICAgICAgIGEgYXMgUHJvY2Vzc2luZ0luc3RydWN0aW9uLFxuICAgICAgICBiIGFzIFByb2Nlc3NpbmdJbnN0cnVjdGlvbixcbiAgICAgIClcbiAgICBjYXNlIE5vZGUuVEVYVF9OT0RFOlxuICAgIGNhc2UgTm9kZS5DT01NRU5UX05PREU6XG4gICAgICByZXR1cm4gY2hlY2tEYXRhKGEgYXMgVGV4dCB8IENvbW1lbnQsIGIgYXMgVGV4dCB8IENvbW1lbnQpXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB0cnVlXG4gIH1cbn1cblxuZnVuY3Rpb24qIGFsbENoaWxkcmVuKG5vZGU6IEVsZW1lbnQpOiBJdGVyYWJsZUl0ZXJhdG9yPEVsZW1lbnQ+IHtcbiAgZm9yIChjb25zdCBjIG9mIG5vZGUuY2hpbGRyZW4pIHtcbiAgICBpZiAoYy50YWdOYW1lID09PSAnU1BBTicgJiYgYy5jbGFzc0xpc3QuY29udGFpbnMoJ01hdGhKYXgnKSkgY29udGludWVcbiAgICBpZiAoYy50YWdOYW1lID09PSAnU1BBTicgJiYgYy5jbGFzc0xpc3QuY29udGFpbnMoJ01hdGhKYXhfU1ZHJykpIGNvbnRpbnVlXG4gICAgaWYgKGMudGFnTmFtZSA9PT0gJ1NDUklQVCcpIGNvbnRpbnVlXG4gICAgaWYgKGMudGFnTmFtZSA9PT0gJ0RJVicgJiYgYy5jbGFzc0xpc3QuY29udGFpbnMoJ01hdGhKYXhfRGlzcGxheScpKSBjb250aW51ZVxuICAgIGlmIChjLnRhZ05hbWUgPT09ICdESVYnICYmIGMuY2xhc3NMaXN0LmNvbnRhaW5zKCdNYXRoSmF4X1NWR19EaXNwbGF5JykpIHtcbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuICAgIHlpZWxkIGNcbiAgICB5aWVsZCogYWxsQ2hpbGRyZW4oYylcbiAgfVxufVxuXG5mdW5jdGlvbiBydW5IZXVyaXN0aWMoXG4gIGlkTWFwOiBXZWFrTWFwPE5vZGUsIHN0cmluZz4sXG4gIG5ld0RvbTogRWxlbWVudCxcbiAgb2xkRG9tOiBFbGVtZW50LFxuKTogdm9pZCB7XG4gIGxldCBpZHggPSAwXG4gIC8vIHByZS1tYXRjaCBub2RlcyBpbiBib3RoIHRyZWVzXG4gIGZ1bmN0aW9uIG1hdGNoRWxzKG5ld1Jvb3Q6IE5vZGUsIG9sZFJvb3Q6IE5vZGUpIHtcbiAgICBsZXQgbmV3RWwgPSBuZXdSb290LmZpcnN0Q2hpbGRcbiAgICBsZXQgb2xkRWwgPSBvbGRSb290LmZpcnN0Q2hpbGRcbiAgICBjb25zdCBuZXdDb3VudCA9IG5ld1Jvb3QuY2hpbGROb2Rlcy5sZW5ndGhcbiAgICBjb25zdCBvbGRDb3VudCA9IG9sZFJvb3QuY2hpbGROb2Rlcy5sZW5ndGhcbiAgICBpZiAobmV3Q291bnQgPiBvbGRDb3VudCkge1xuICAgICAgLy8gY2hlY2tpbmcgZm9yIGluc2VydGlvbnNcbiAgICAgIHdoaWxlIChvbGRFbCAmJiBuZXdFbCkge1xuICAgICAgICBpZiAoaXNFcXVhbChuZXdFbCwgb2xkRWwpKSB7XG4gICAgICAgICAgaWYgKG5ld0VsLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSkge1xuICAgICAgICAgICAgY29uc3Qgc2lkeCA9IGlkeC50b1N0cmluZygzNilcbiAgICAgICAgICAgIGlkTWFwLnNldChvbGRFbCwgc2lkeClcbiAgICAgICAgICAgIGlkTWFwLnNldChuZXdFbCwgc2lkeClcbiAgICAgICAgICAgIGlkeCsrXG4gICAgICAgICAgfVxuICAgICAgICAgIG1hdGNoRWxzKG5ld0VsLCBvbGRFbClcbiAgICAgICAgICBvbGRFbCA9IG9sZEVsLm5leHRTaWJsaW5nXG4gICAgICAgIH1cbiAgICAgICAgbmV3RWwgPSBuZXdFbC5uZXh0U2libGluZ1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAobmV3Q291bnQgPCBvbGRDb3VudCkge1xuICAgICAgLy8gY2hlY2tpbmcgZm9yIGRlbGV0aW9uc1xuICAgICAgd2hpbGUgKG9sZEVsICYmIG5ld0VsKSB7XG4gICAgICAgIGlmIChpc0VxdWFsKG5ld0VsLCBvbGRFbCkpIHtcbiAgICAgICAgICBpZiAobmV3RWwubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgICAgICBjb25zdCBzaWR4ID0gaWR4LnRvU3RyaW5nKDM2KVxuICAgICAgICAgICAgaWRNYXAuc2V0KG9sZEVsLCBzaWR4KVxuICAgICAgICAgICAgaWRNYXAuc2V0KG5ld0VsLCBzaWR4KVxuICAgICAgICAgICAgaWR4KytcbiAgICAgICAgICB9XG4gICAgICAgICAgbWF0Y2hFbHMobmV3RWwsIG9sZEVsKVxuICAgICAgICAgIG5ld0VsID0gbmV3RWwubmV4dFNpYmxpbmdcbiAgICAgICAgfVxuICAgICAgICBvbGRFbCA9IG9sZEVsLm5leHRTaWJsaW5nXG4gICAgICB9XG4gICAgfVxuICB9XG4gIG1hdGNoRWxzKG5ld0RvbSwgb2xkRG9tKVxufVxuXG5mdW5jdGlvbiB0aW1lPFQ+KGNiOiAoKSA9PiBUKTogVCB7XG4gIGNvbnN0IHN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KClcbiAgY29uc3QgcmVzID0gY2IoKVxuICBjb25zb2xlLmxvZyhjYi50b1N0cmluZygpLCBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0LCAnbXMnKVxuICByZXR1cm4gcmVzXG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlKFxuICBvbGREb206IEVsZW1lbnQsXG4gIG5ld0RvbTogRWxlbWVudCxcbiAgb3B0czoge1xuICAgIG1qQ29udHJvbGxlcjogTWF0aEpheENvbnRyb2xsZXJcbiAgICByZW5kZXJMYVRlWDogYm9vbGVhblxuICAgIGRpZmZNZXRob2Q6IFREaWZmTWV0aG9kXG4gIH0sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgaWRNYXAgPSBuZXcgV2Vha01hcDxOb2RlLCBzdHJpbmc+KClcbiAgc3dpdGNoIChvcHRzLmRpZmZNZXRob2QpIHtcbiAgICBjYXNlICdoZXVyaXN0aWMnOiB7XG4gICAgICB0aW1lKCgpID0+IHJ1bkhldXJpc3RpYyhpZE1hcCwgbmV3RG9tLCBvbGREb20pKVxuICAgICAgYnJlYWtcbiAgICB9XG4gICAgY2FzZSAnbXllcnMnOiB7XG4gICAgICBjb25zdCBhID0gdGltZSgoKSA9PiBBcnJheS5mcm9tKGFsbENoaWxkcmVuKG9sZERvbSkpKVxuICAgICAgY29uc3QgYiA9IHRpbWUoKCkgPT4gQXJyYXkuZnJvbShhbGxDaGlsZHJlbihuZXdEb20pKSlcbiAgICAgIGxldCBuY29tcCA9IDBcbiAgICAgIGxldCBpZHggPSAwXG4gICAgICB0aW1lKCgpID0+XG4gICAgICAgIGRpZmYoXG4gICAgICAgICAgYSxcbiAgICAgICAgICBiLFxuICAgICAgICAgIChhLCBiKSA9PiB7XG4gICAgICAgICAgICBuY29tcCsrXG4gICAgICAgICAgICByZXR1cm4gaXNFcXVhbChhLCBiKVxuICAgICAgICAgIH0sXG4gICAgICAgICAgKHBhaXJzKSA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFt4LCB5XSBvZiBwYWlycykge1xuICAgICAgICAgICAgICBjb25zdCBzaWR4ID0gaWR4LnRvU3RyaW5nKDM2KVxuICAgICAgICAgICAgICBpZE1hcC5zZXQoeCwgc2lkeClcbiAgICAgICAgICAgICAgaWRNYXAuc2V0KHksIHNpZHgpXG4gICAgICAgICAgICAgIGlkeCsrXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgKSxcbiAgICAgIClcbiAgICAgIGNvbnNvbGUubG9nKCdhOicsIGEubGVuZ3RoLCAnYjonLCBiLmxlbmd0aCwgJ2NvbXA6JywgbmNvbXApXG4gICAgICBicmVha1xuICAgIH1cbiAgICBjYXNlICdub25lJzpcbiAgICAgIGJyZWFrXG4gIH1cblxuICB0cnkge1xuICAgIG1vcnBoKG9sZERvbSwgbmV3RG9tLCB7XG4gICAgICBjaGlsZHJlbk9ubHk6IHRydWUsXG4gICAgICBvbkJlZm9yZUVsVXBkYXRlZChmcm9tRWwsIHRvRWwpIHtcbiAgICAgICAgaWYgKGZyb21FbC5pc0VxdWFsTm9kZSh0b0VsKSkgcmV0dXJuIGZhbHNlXG4gICAgICAgIGNvbnN0IHRjcyA9IGdldE1hdGhDb250ZW50cyhmcm9tRWwsIHRvRWwpXG4gICAgICAgIGlmICh0Y3MpIHtcbiAgICAgICAgICBpZiAodGNzWzBdLnRleHRDb250ZW50ICE9PSB0Y3NbMV0udGV4dENvbnRlbnQpIHtcbiAgICAgICAgICAgIHRjc1swXS50ZXh0Q29udGVudCA9IHRjc1sxXS50ZXh0Q29udGVudFxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSxcbiAgICAgIGdldE5vZGVLZXkobm9kZTogRWxlbWVudCkge1xuICAgICAgICByZXR1cm4gaWRNYXAuZ2V0KG5vZGUpIHx8ICcnXG4gICAgICB9LFxuICAgIH0pXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKGUpXG4gICAgb2xkRG9tLmlubmVySFRNTCA9IG5ld0RvbS5pbm5lckhUTUxcbiAgfVxuXG4gIGlmIChvcHRzLnJlbmRlckxhVGVYKSBhd2FpdCBvcHRzLm1qQ29udHJvbGxlci5xdWV1ZVR5cGVzZXQob2xkRG9tKVxufVxuIl19","var DOCUMENT_FRAGMENT_NODE = 11;\n\nfunction morphAttrs(fromNode, toNode) {\n    var toNodeAttrs = toNode.attributes;\n    var attr;\n    var attrName;\n    var attrNamespaceURI;\n    var attrValue;\n    var fromValue;\n\n    // document-fragments dont have attributes so lets not do anything\n    if (toNode.nodeType === DOCUMENT_FRAGMENT_NODE || fromNode.nodeType === DOCUMENT_FRAGMENT_NODE) {\n      return;\n    }\n\n    // update attributes on original DOM element\n    for (var i = toNodeAttrs.length - 1; i >= 0; i--) {\n        attr = toNodeAttrs[i];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n        attrValue = attr.value;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n            fromValue = fromNode.getAttributeNS(attrNamespaceURI, attrName);\n\n            if (fromValue !== attrValue) {\n                if (attr.prefix === 'xmlns'){\n                    attrName = attr.name; // It's not allowed to set an attribute with the XMLNS namespace without specifying the `xmlns` prefix\n                }\n                fromNode.setAttributeNS(attrNamespaceURI, attrName, attrValue);\n            }\n        } else {\n            fromValue = fromNode.getAttribute(attrName);\n\n            if (fromValue !== attrValue) {\n                fromNode.setAttribute(attrName, attrValue);\n            }\n        }\n    }\n\n    // Remove any extra attributes found on the original DOM element that\n    // weren't found on the target element.\n    var fromNodeAttrs = fromNode.attributes;\n\n    for (var d = fromNodeAttrs.length - 1; d >= 0; d--) {\n        attr = fromNodeAttrs[d];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n\n            if (!toNode.hasAttributeNS(attrNamespaceURI, attrName)) {\n                fromNode.removeAttributeNS(attrNamespaceURI, attrName);\n            }\n        } else {\n            if (!toNode.hasAttribute(attrName)) {\n                fromNode.removeAttribute(attrName);\n            }\n        }\n    }\n}\n\nvar range; // Create a range object for efficently rendering strings to elements.\nvar NS_XHTML = 'http://www.w3.org/1999/xhtml';\n\nvar doc = typeof document === 'undefined' ? undefined : document;\nvar HAS_TEMPLATE_SUPPORT = !!doc && 'content' in doc.createElement('template');\nvar HAS_RANGE_SUPPORT = !!doc && doc.createRange && 'createContextualFragment' in doc.createRange();\n\nfunction createFragmentFromTemplate(str) {\n    var template = doc.createElement('template');\n    template.innerHTML = str;\n    return template.content.childNodes[0];\n}\n\nfunction createFragmentFromRange(str) {\n    if (!range) {\n        range = doc.createRange();\n        range.selectNode(doc.body);\n    }\n\n    var fragment = range.createContextualFragment(str);\n    return fragment.childNodes[0];\n}\n\nfunction createFragmentFromWrap(str) {\n    var fragment = doc.createElement('body');\n    fragment.innerHTML = str;\n    return fragment.childNodes[0];\n}\n\n/**\n * This is about the same\n * var html = new DOMParser().parseFromString(str, 'text/html');\n * return html.body.firstChild;\n *\n * @method toElement\n * @param {String} str\n */\nfunction toElement(str) {\n    str = str.trim();\n    if (HAS_TEMPLATE_SUPPORT) {\n      // avoid restrictions on content for things like `<tr><th>Hi</th></tr>` which\n      // createContextualFragment doesn't support\n      // <template> support not available in IE\n      return createFragmentFromTemplate(str);\n    } else if (HAS_RANGE_SUPPORT) {\n      return createFragmentFromRange(str);\n    }\n\n    return createFragmentFromWrap(str);\n}\n\n/**\n * Returns true if two node's names are the same.\n *\n * NOTE: We don't bother checking `namespaceURI` because you will never find two HTML elements with the same\n *       nodeName and different namespace URIs.\n *\n * @param {Element} a\n * @param {Element} b The target element\n * @return {boolean}\n */\nfunction compareNodeNames(fromEl, toEl) {\n    var fromNodeName = fromEl.nodeName;\n    var toNodeName = toEl.nodeName;\n    var fromCodeStart, toCodeStart;\n\n    if (fromNodeName === toNodeName) {\n        return true;\n    }\n\n    fromCodeStart = fromNodeName.charCodeAt(0);\n    toCodeStart = toNodeName.charCodeAt(0);\n\n    // If the target element is a virtual DOM node or SVG node then we may\n    // need to normalize the tag name before comparing. Normal HTML elements that are\n    // in the \"http://www.w3.org/1999/xhtml\"\n    // are converted to upper case\n    if (fromCodeStart <= 90 && toCodeStart >= 97) { // from is upper and to is lower\n        return fromNodeName === toNodeName.toUpperCase();\n    } else if (toCodeStart <= 90 && fromCodeStart >= 97) { // to is upper and from is lower\n        return toNodeName === fromNodeName.toUpperCase();\n    } else {\n        return false;\n    }\n}\n\n/**\n * Create an element, optionally with a known namespace URI.\n *\n * @param {string} name the element name, e.g. 'div' or 'svg'\n * @param {string} [namespaceURI] the element's namespace URI, i.e. the value of\n * its `xmlns` attribute or its inferred namespace.\n *\n * @return {Element}\n */\nfunction createElementNS(name, namespaceURI) {\n    return !namespaceURI || namespaceURI === NS_XHTML ?\n        doc.createElement(name) :\n        doc.createElementNS(namespaceURI, name);\n}\n\n/**\n * Copies the children of one DOM element to another DOM element\n */\nfunction moveChildren(fromEl, toEl) {\n    var curChild = fromEl.firstChild;\n    while (curChild) {\n        var nextChild = curChild.nextSibling;\n        toEl.appendChild(curChild);\n        curChild = nextChild;\n    }\n    return toEl;\n}\n\nfunction syncBooleanAttrProp(fromEl, toEl, name) {\n    if (fromEl[name] !== toEl[name]) {\n        fromEl[name] = toEl[name];\n        if (fromEl[name]) {\n            fromEl.setAttribute(name, '');\n        } else {\n            fromEl.removeAttribute(name);\n        }\n    }\n}\n\nvar specialElHandlers = {\n    OPTION: function(fromEl, toEl) {\n        var parentNode = fromEl.parentNode;\n        if (parentNode) {\n            var parentName = parentNode.nodeName.toUpperCase();\n            if (parentName === 'OPTGROUP') {\n                parentNode = parentNode.parentNode;\n                parentName = parentNode && parentNode.nodeName.toUpperCase();\n            }\n            if (parentName === 'SELECT' && !parentNode.hasAttribute('multiple')) {\n                if (fromEl.hasAttribute('selected') && !toEl.selected) {\n                    // Workaround for MS Edge bug where the 'selected' attribute can only be\n                    // removed if set to a non-empty value:\n                    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12087679/\n                    fromEl.setAttribute('selected', 'selected');\n                    fromEl.removeAttribute('selected');\n                }\n                // We have to reset select element's selectedIndex to -1, otherwise setting\n                // fromEl.selected using the syncBooleanAttrProp below has no effect.\n                // The correct selectedIndex will be set in the SELECT special handler below.\n                parentNode.selectedIndex = -1;\n            }\n        }\n        syncBooleanAttrProp(fromEl, toEl, 'selected');\n    },\n    /**\n     * The \"value\" attribute is special for the <input> element since it sets\n     * the initial value. Changing the \"value\" attribute without changing the\n     * \"value\" property will have no effect since it is only used to the set the\n     * initial value.  Similar for the \"checked\" attribute, and \"disabled\".\n     */\n    INPUT: function(fromEl, toEl) {\n        syncBooleanAttrProp(fromEl, toEl, 'checked');\n        syncBooleanAttrProp(fromEl, toEl, 'disabled');\n\n        if (fromEl.value !== toEl.value) {\n            fromEl.value = toEl.value;\n        }\n\n        if (!toEl.hasAttribute('value')) {\n            fromEl.removeAttribute('value');\n        }\n    },\n\n    TEXTAREA: function(fromEl, toEl) {\n        var newValue = toEl.value;\n        if (fromEl.value !== newValue) {\n            fromEl.value = newValue;\n        }\n\n        var firstChild = fromEl.firstChild;\n        if (firstChild) {\n            // Needed for IE. Apparently IE sets the placeholder as the\n            // node value and vise versa. This ignores an empty update.\n            var oldValue = firstChild.nodeValue;\n\n            if (oldValue == newValue || (!newValue && oldValue == fromEl.placeholder)) {\n                return;\n            }\n\n            firstChild.nodeValue = newValue;\n        }\n    },\n    SELECT: function(fromEl, toEl) {\n        if (!toEl.hasAttribute('multiple')) {\n            var selectedIndex = -1;\n            var i = 0;\n            // We have to loop through children of fromEl, not toEl since nodes can be moved\n            // from toEl to fromEl directly when morphing.\n            // At the time this special handler is invoked, all children have already been morphed\n            // and appended to / removed from fromEl, so using fromEl here is safe and correct.\n            var curChild = fromEl.firstChild;\n            var optgroup;\n            var nodeName;\n            while(curChild) {\n                nodeName = curChild.nodeName && curChild.nodeName.toUpperCase();\n                if (nodeName === 'OPTGROUP') {\n                    optgroup = curChild;\n                    curChild = optgroup.firstChild;\n                } else {\n                    if (nodeName === 'OPTION') {\n                        if (curChild.hasAttribute('selected')) {\n                            selectedIndex = i;\n                            break;\n                        }\n                        i++;\n                    }\n                    curChild = curChild.nextSibling;\n                    if (!curChild && optgroup) {\n                        curChild = optgroup.nextSibling;\n                        optgroup = null;\n                    }\n                }\n            }\n\n            fromEl.selectedIndex = selectedIndex;\n        }\n    }\n};\n\nvar ELEMENT_NODE = 1;\nvar DOCUMENT_FRAGMENT_NODE$1 = 11;\nvar TEXT_NODE = 3;\nvar COMMENT_NODE = 8;\n\nfunction noop() {}\n\nfunction defaultGetNodeKey(node) {\n  if (node) {\n      return (node.getAttribute && node.getAttribute('id')) || node.id;\n  }\n}\n\nfunction morphdomFactory(morphAttrs) {\n\n    return function morphdom(fromNode, toNode, options) {\n        if (!options) {\n            options = {};\n        }\n\n        if (typeof toNode === 'string') {\n            if (fromNode.nodeName === '#document' || fromNode.nodeName === 'HTML' || fromNode.nodeName === 'BODY') {\n                var toNodeHtml = toNode;\n                toNode = doc.createElement('html');\n                toNode.innerHTML = toNodeHtml;\n            } else {\n                toNode = toElement(toNode);\n            }\n        }\n\n        var getNodeKey = options.getNodeKey || defaultGetNodeKey;\n        var onBeforeNodeAdded = options.onBeforeNodeAdded || noop;\n        var onNodeAdded = options.onNodeAdded || noop;\n        var onBeforeElUpdated = options.onBeforeElUpdated || noop;\n        var onElUpdated = options.onElUpdated || noop;\n        var onBeforeNodeDiscarded = options.onBeforeNodeDiscarded || noop;\n        var onNodeDiscarded = options.onNodeDiscarded || noop;\n        var onBeforeElChildrenUpdated = options.onBeforeElChildrenUpdated || noop;\n        var childrenOnly = options.childrenOnly === true;\n\n        // This object is used as a lookup to quickly find all keyed elements in the original DOM tree.\n        var fromNodesLookup = Object.create(null);\n        var keyedRemovalList = [];\n\n        function addKeyedRemoval(key) {\n            keyedRemovalList.push(key);\n        }\n\n        function walkDiscardedChildNodes(node, skipKeyedNodes) {\n            if (node.nodeType === ELEMENT_NODE) {\n                var curChild = node.firstChild;\n                while (curChild) {\n\n                    var key = undefined;\n\n                    if (skipKeyedNodes && (key = getNodeKey(curChild))) {\n                        // If we are skipping keyed nodes then we add the key\n                        // to a list so that it can be handled at the very end.\n                        addKeyedRemoval(key);\n                    } else {\n                        // Only report the node as discarded if it is not keyed. We do this because\n                        // at the end we loop through all keyed elements that were unmatched\n                        // and then discard them in one final pass.\n                        onNodeDiscarded(curChild);\n                        if (curChild.firstChild) {\n                            walkDiscardedChildNodes(curChild, skipKeyedNodes);\n                        }\n                    }\n\n                    curChild = curChild.nextSibling;\n                }\n            }\n        }\n\n        /**\n         * Removes a DOM node out of the original DOM\n         *\n         * @param  {Node} node The node to remove\n         * @param  {Node} parentNode The nodes parent\n         * @param  {Boolean} skipKeyedNodes If true then elements with keys will be skipped and not discarded.\n         * @return {undefined}\n         */\n        function removeNode(node, parentNode, skipKeyedNodes) {\n            if (onBeforeNodeDiscarded(node) === false) {\n                return;\n            }\n\n            if (parentNode) {\n                parentNode.removeChild(node);\n            }\n\n            onNodeDiscarded(node);\n            walkDiscardedChildNodes(node, skipKeyedNodes);\n        }\n\n        // // TreeWalker implementation is no faster, but keeping this around in case this changes in the future\n        // function indexTree(root) {\n        //     var treeWalker = document.createTreeWalker(\n        //         root,\n        //         NodeFilter.SHOW_ELEMENT);\n        //\n        //     var el;\n        //     while((el = treeWalker.nextNode())) {\n        //         var key = getNodeKey(el);\n        //         if (key) {\n        //             fromNodesLookup[key] = el;\n        //         }\n        //     }\n        // }\n\n        // // NodeIterator implementation is no faster, but keeping this around in case this changes in the future\n        //\n        // function indexTree(node) {\n        //     var nodeIterator = document.createNodeIterator(node, NodeFilter.SHOW_ELEMENT);\n        //     var el;\n        //     while((el = nodeIterator.nextNode())) {\n        //         var key = getNodeKey(el);\n        //         if (key) {\n        //             fromNodesLookup[key] = el;\n        //         }\n        //     }\n        // }\n\n        function indexTree(node) {\n            if (node.nodeType === ELEMENT_NODE || node.nodeType === DOCUMENT_FRAGMENT_NODE$1) {\n                var curChild = node.firstChild;\n                while (curChild) {\n                    var key = getNodeKey(curChild);\n                    if (key) {\n                        fromNodesLookup[key] = curChild;\n                    }\n\n                    // Walk recursively\n                    indexTree(curChild);\n\n                    curChild = curChild.nextSibling;\n                }\n            }\n        }\n\n        indexTree(fromNode);\n\n        function handleNodeAdded(el) {\n            onNodeAdded(el);\n\n            var curChild = el.firstChild;\n            while (curChild) {\n                var nextSibling = curChild.nextSibling;\n\n                var key = getNodeKey(curChild);\n                if (key) {\n                    var unmatchedFromEl = fromNodesLookup[key];\n                    // if we find a duplicate #id node in cache, replace `el` with cache value\n                    // and morph it to the child node.\n                    if (unmatchedFromEl && compareNodeNames(curChild, unmatchedFromEl)) {\n                        curChild.parentNode.replaceChild(unmatchedFromEl, curChild);\n                        morphEl(unmatchedFromEl, curChild);\n                    } else {\n                      handleNodeAdded(curChild);\n                    }\n                } else {\n                  // recursively call for curChild and it's children to see if we find something in\n                  // fromNodesLookup\n                  handleNodeAdded(curChild);\n                }\n\n                curChild = nextSibling;\n            }\n        }\n\n        function cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey) {\n            // We have processed all of the \"to nodes\". If curFromNodeChild is\n            // non-null then we still have some from nodes left over that need\n            // to be removed\n            while (curFromNodeChild) {\n                var fromNextSibling = curFromNodeChild.nextSibling;\n                if ((curFromNodeKey = getNodeKey(curFromNodeChild))) {\n                    // Since the node is keyed it might be matched up later so we defer\n                    // the actual removal to later\n                    addKeyedRemoval(curFromNodeKey);\n                } else {\n                    // NOTE: we skip nested keyed nodes from being removed since there is\n                    //       still a chance they will be matched up later\n                    removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                }\n                curFromNodeChild = fromNextSibling;\n            }\n        }\n\n        function morphEl(fromEl, toEl, childrenOnly) {\n            var toElKey = getNodeKey(toEl);\n\n            if (toElKey) {\n                // If an element with an ID is being morphed then it will be in the final\n                // DOM so clear it out of the saved elements collection\n                delete fromNodesLookup[toElKey];\n            }\n\n            if (!childrenOnly) {\n                // optional\n                if (onBeforeElUpdated(fromEl, toEl) === false) {\n                    return;\n                }\n\n                // update attributes on original DOM element first\n                morphAttrs(fromEl, toEl);\n                // optional\n                onElUpdated(fromEl);\n\n                if (onBeforeElChildrenUpdated(fromEl, toEl) === false) {\n                    return;\n                }\n            }\n\n            if (fromEl.nodeName !== 'TEXTAREA') {\n              morphChildren(fromEl, toEl);\n            } else {\n              specialElHandlers.TEXTAREA(fromEl, toEl);\n            }\n        }\n\n        function morphChildren(fromEl, toEl) {\n            var curToNodeChild = toEl.firstChild;\n            var curFromNodeChild = fromEl.firstChild;\n            var curToNodeKey;\n            var curFromNodeKey;\n\n            var fromNextSibling;\n            var toNextSibling;\n            var matchingFromEl;\n\n            // walk the children\n            outer: while (curToNodeChild) {\n                toNextSibling = curToNodeChild.nextSibling;\n                curToNodeKey = getNodeKey(curToNodeChild);\n\n                // walk the fromNode children all the way through\n                while (curFromNodeChild) {\n                    fromNextSibling = curFromNodeChild.nextSibling;\n\n                    if (curToNodeChild.isSameNode && curToNodeChild.isSameNode(curFromNodeChild)) {\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    curFromNodeKey = getNodeKey(curFromNodeChild);\n\n                    var curFromNodeType = curFromNodeChild.nodeType;\n\n                    // this means if the curFromNodeChild doesnt have a match with the curToNodeChild\n                    var isCompatible = undefined;\n\n                    if (curFromNodeType === curToNodeChild.nodeType) {\n                        if (curFromNodeType === ELEMENT_NODE) {\n                            // Both nodes being compared are Element nodes\n\n                            if (curToNodeKey) {\n                                // The target node has a key so we want to match it up with the correct element\n                                // in the original DOM tree\n                                if (curToNodeKey !== curFromNodeKey) {\n                                    // The current element in the original DOM tree does not have a matching key so\n                                    // let's check our lookup to see if there is a matching element in the original\n                                    // DOM tree\n                                    if ((matchingFromEl = fromNodesLookup[curToNodeKey])) {\n                                        if (fromNextSibling === matchingFromEl) {\n                                            // Special case for single element removals. To avoid removing the original\n                                            // DOM node out of the tree (since that can break CSS transitions, etc.),\n                                            // we will instead discard the current node and wait until the next\n                                            // iteration to properly match up the keyed target element with its matching\n                                            // element in the original tree\n                                            isCompatible = false;\n                                        } else {\n                                            // We found a matching keyed element somewhere in the original DOM tree.\n                                            // Let's move the original DOM node into the current position and morph\n                                            // it.\n\n                                            // NOTE: We use insertBefore instead of replaceChild because we want to go through\n                                            // the `removeNode()` function for the node that is being discarded so that\n                                            // all lifecycle hooks are correctly invoked\n                                            fromEl.insertBefore(matchingFromEl, curFromNodeChild);\n\n                                            // fromNextSibling = curFromNodeChild.nextSibling;\n\n                                            if (curFromNodeKey) {\n                                                // Since the node is keyed it might be matched up later so we defer\n                                                // the actual removal to later\n                                                addKeyedRemoval(curFromNodeKey);\n                                            } else {\n                                                // NOTE: we skip nested keyed nodes from being removed since there is\n                                                //       still a chance they will be matched up later\n                                                removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                                            }\n\n                                            curFromNodeChild = matchingFromEl;\n                                        }\n                                    } else {\n                                        // The nodes are not compatible since the \"to\" node has a key and there\n                                        // is no matching keyed node in the source tree\n                                        isCompatible = false;\n                                    }\n                                }\n                            } else if (curFromNodeKey) {\n                                // The original has a key\n                                isCompatible = false;\n                            }\n\n                            isCompatible = isCompatible !== false && compareNodeNames(curFromNodeChild, curToNodeChild);\n                            if (isCompatible) {\n                                // We found compatible DOM elements so transform\n                                // the current \"from\" node to match the current\n                                // target DOM node.\n                                // MORPH\n                                morphEl(curFromNodeChild, curToNodeChild);\n                            }\n\n                        } else if (curFromNodeType === TEXT_NODE || curFromNodeType == COMMENT_NODE) {\n                            // Both nodes being compared are Text or Comment nodes\n                            isCompatible = true;\n                            // Simply update nodeValue on the original node to\n                            // change the text value\n                            if (curFromNodeChild.nodeValue !== curToNodeChild.nodeValue) {\n                                curFromNodeChild.nodeValue = curToNodeChild.nodeValue;\n                            }\n\n                        }\n                    }\n\n                    if (isCompatible) {\n                        // Advance both the \"to\" child and the \"from\" child since we found a match\n                        // Nothing else to do as we already recursively called morphChildren above\n                        curToNodeChild = toNextSibling;\n                        curFromNodeChild = fromNextSibling;\n                        continue outer;\n                    }\n\n                    // No compatible match so remove the old node from the DOM and continue trying to find a\n                    // match in the original DOM. However, we only do this if the from node is not keyed\n                    // since it is possible that a keyed node might match up with a node somewhere else in the\n                    // target tree and we don't want to discard it just yet since it still might find a\n                    // home in the final DOM tree. After everything is done we will remove any keyed nodes\n                    // that didn't find a home\n                    if (curFromNodeKey) {\n                        // Since the node is keyed it might be matched up later so we defer\n                        // the actual removal to later\n                        addKeyedRemoval(curFromNodeKey);\n                    } else {\n                        // NOTE: we skip nested keyed nodes from being removed since there is\n                        //       still a chance they will be matched up later\n                        removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                    }\n\n                    curFromNodeChild = fromNextSibling;\n                } // END: while(curFromNodeChild) {}\n\n                // If we got this far then we did not find a candidate match for\n                // our \"to node\" and we exhausted all of the children \"from\"\n                // nodes. Therefore, we will just append the current \"to\" node\n                // to the end\n                if (curToNodeKey && (matchingFromEl = fromNodesLookup[curToNodeKey]) && compareNodeNames(matchingFromEl, curToNodeChild)) {\n                    fromEl.appendChild(matchingFromEl);\n                    // MORPH\n                    morphEl(matchingFromEl, curToNodeChild);\n                } else {\n                    var onBeforeNodeAddedResult = onBeforeNodeAdded(curToNodeChild);\n                    if (onBeforeNodeAddedResult !== false) {\n                        if (onBeforeNodeAddedResult) {\n                            curToNodeChild = onBeforeNodeAddedResult;\n                        }\n\n                        if (curToNodeChild.actualize) {\n                            curToNodeChild = curToNodeChild.actualize(fromEl.ownerDocument || doc);\n                        }\n                        fromEl.appendChild(curToNodeChild);\n                        handleNodeAdded(curToNodeChild);\n                    }\n                }\n\n                curToNodeChild = toNextSibling;\n                curFromNodeChild = fromNextSibling;\n            }\n\n            cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey);\n\n            var specialElHandler = specialElHandlers[fromEl.nodeName];\n            if (specialElHandler) {\n                specialElHandler(fromEl, toEl);\n            }\n        } // END: morphChildren(...)\n\n        var morphedNode = fromNode;\n        var morphedNodeType = morphedNode.nodeType;\n        var toNodeType = toNode.nodeType;\n\n        if (!childrenOnly) {\n            // Handle the case where we are given two DOM nodes that are not\n            // compatible (e.g. <div> --> <span> or <div> --> TEXT)\n            if (morphedNodeType === ELEMENT_NODE) {\n                if (toNodeType === ELEMENT_NODE) {\n                    if (!compareNodeNames(fromNode, toNode)) {\n                        onNodeDiscarded(fromNode);\n                        morphedNode = moveChildren(fromNode, createElementNS(toNode.nodeName, toNode.namespaceURI));\n                    }\n                } else {\n                    // Going from an element node to a text node\n                    morphedNode = toNode;\n                }\n            } else if (morphedNodeType === TEXT_NODE || morphedNodeType === COMMENT_NODE) { // Text or comment node\n                if (toNodeType === morphedNodeType) {\n                    if (morphedNode.nodeValue !== toNode.nodeValue) {\n                        morphedNode.nodeValue = toNode.nodeValue;\n                    }\n\n                    return morphedNode;\n                } else {\n                    // Text node to something else\n                    morphedNode = toNode;\n                }\n            }\n        }\n\n        if (morphedNode === toNode) {\n            // The \"to node\" was not compatible with the \"from node\" so we had to\n            // toss out the \"from node\" and use the \"to node\"\n            onNodeDiscarded(fromNode);\n        } else {\n            if (toNode.isSameNode && toNode.isSameNode(morphedNode)) {\n                return;\n            }\n\n            morphEl(morphedNode, toNode, childrenOnly);\n\n            // We now need to loop over any keyed nodes that might need to be\n            // removed. We only do the removal if we know that the keyed node\n            // never found a match. When a keyed node is matched up we remove\n            // it out of fromNodesLookup and we use fromNodesLookup to determine\n            // if a keyed node has been matched up or not\n            if (keyedRemovalList) {\n                for (var i=0, len=keyedRemovalList.length; i<len; i++) {\n                    var elToRemove = fromNodesLookup[keyedRemovalList[i]];\n                    if (elToRemove) {\n                        removeNode(elToRemove, elToRemove.parentNode, false);\n                    }\n                }\n            }\n        }\n\n        if (!childrenOnly && morphedNode !== fromNode && fromNode.parentNode) {\n            if (morphedNode.actualize) {\n                morphedNode = morphedNode.actualize(fromNode.ownerDocument || doc);\n            }\n            // If we had to swap out the from node with a new node because the old\n            // node was not compatible with the target node then we need to\n            // replace the old DOM node in the original DOM tree. This is only\n            // possible if the original DOM node was part of a DOM tree which\n            // we know is the case if it has a parent node.\n            fromNode.parentNode.replaceChild(morphedNode, fromNode);\n        }\n\n        return morphedNode;\n    };\n}\n\nvar morphdom = morphdomFactory(morphAttrs);\n\nexport default morphdom;\n","import { zip } from './util';\nexport function diff(left, right, compare, match) {\n    const slices = [];\n    function go(e, f, i = 0, j = 0) {\n        const [N, M, L, Z] = [\n            e.length,\n            f.length,\n            e.length + f.length,\n            2 * Math.min(e.length, f.length) + 2,\n        ];\n        if (N > 0 && M > 0) {\n            const [w, g, p] = [\n                N - M,\n                Array(Z).fill(0),\n                Array(Z).fill(0),\n            ];\n            for (let h = 0; h < L / 2 + (L % 2) + 1; h++) {\n                for (let r = 0; r < 2; r++) {\n                    const [c, d, o, m] = r === 0 ? [g, p, 1, 1] : [p, g, 0, -1];\n                    for (let k = -(h - 2 * Math.max(0, h - M)); k < h - 2 * Math.max(0, h - N) + 1; k += 2) {\n                        let a = k === -h || (k !== h && c[(k - 1) % Z] < c[(k + 1) % Z])\n                            ? c[(k + 1) % Z]\n                            : c[(k - 1) % Z] + 1;\n                        let b = a - k;\n                        const [s, t] = [a, b];\n                        while (a < N &&\n                            b < M &&\n                            compare(e[(1 - o) * N + m * a + (o - 1)], f[(1 - o) * M + m * b + (o - 1)])) {\n                            a++, b++;\n                        }\n                        c[k % Z] = a;\n                        const z = -(k - w);\n                        if (L % 2 === o &&\n                            z >= -(h - o) &&\n                            z <= h - o &&\n                            c[k % Z] + d[z % Z] >= N) {\n                            const [D, x, y, u, v] = o === 1\n                                ? [2 * h - 1, s, t, a, b]\n                                : [2 * h, N - a, M - b, N - s, M - t];\n                            if (D > 1 || (x !== u && y !== v)) {\n                                if (x !== u && y !== v) {\n                                    slices.push([e.slice(x, u), f.slice(y, v)]);\n                                }\n                                go(e.slice(0, x), f.slice(0, y), i, j);\n                                go(e.slice(u, N), f.slice(v, M), i + u, j + v);\n                                return;\n                            }\n                            else if (M > N) {\n                                slices.push([e.slice(0, N), f.slice(0, N)]);\n                                return;\n                            }\n                            else if (M < N) {\n                                slices.push([e.slice(0, M), f.slice(0, M)]);\n                                return;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    go(Array.from(left), Array.from(right));\n    match(slicesToItems(slices));\n}\nfunction* slicesToItems(slices) {\n    for (const [a, b] of slices) {\n        yield* zip(a, b);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlmZi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy1jbGllbnQvZGlmZi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFtQkEsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLFFBQVEsQ0FBQTtBQUU1QixNQUFNLFVBQVUsSUFBSSxDQUNsQixJQUFrQixFQUNsQixLQUFtQixFQUNuQixPQUFnQyxFQUNoQyxLQUF3QztJQUV4QyxNQUFNLE1BQU0sR0FBcUIsRUFBRSxDQUFBO0lBQ25DLFNBQVMsRUFBRSxDQUFDLENBQVcsRUFBRSxDQUFXLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQztRQUdoRCxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUc7WUFDbkIsQ0FBQyxDQUFDLE1BQU07WUFDUixDQUFDLENBQUMsTUFBTTtZQUNSLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLE1BQU07WUFDbkIsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQztTQUNyQyxDQUFBO1FBQ0QsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDbEIsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUc7Z0JBQ2hCLENBQUMsR0FBRyxDQUFDO2dCQUNMLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFhO2dCQUM1QixLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBYTthQUM3QixDQUFBO1lBQ0QsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUM1QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO29CQUMxQixNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFBO29CQUMzRCxLQUNFLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUNyQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUNsQyxDQUFDLElBQUksQ0FBQyxFQUNOO3dCQUNBLElBQUksQ0FBQyxHQUNILENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQzs0QkFDdEQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7NEJBQ2hCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO3dCQUN4QixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFBO3dCQUNiLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7d0JBQ3JCLE9BQ0UsQ0FBQyxHQUFHLENBQUM7NEJBQ0wsQ0FBQyxHQUFHLENBQUM7NEJBQ0wsT0FBTyxDQUNMLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUNoQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FDakMsRUFDRDs0QkFDQSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQTt5QkFDVDt3QkFDRCxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTt3QkFDWixNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO3dCQUNsQixJQUNFLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQzs0QkFDWCxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7NEJBQ2IsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDOzRCQUNWLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQ3hCOzRCQUNBLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQ25CLENBQUMsS0FBSyxDQUFDO2dDQUNMLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztnQ0FDekIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7NEJBQ3pDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO2dDQUNqQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRTtvQ0FDdEIsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtpQ0FDNUM7Z0NBR0QsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQTtnQ0FDdEMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO2dDQUM5QyxPQUFNOzZCQUNQO2lDQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRTtnQ0FDaEIsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtnQ0FDM0MsT0FBTTs2QkFFUDtpQ0FBTSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUU7Z0NBQ2hCLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7Z0NBQzNDLE9BQU07NkJBRVA7eUJBQ0Y7cUJBQ0Y7aUJBQ0Y7YUFDRjtTQUNGO0lBTUgsQ0FBQztJQUNELEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQTtJQUN2QyxLQUFLLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUE7QUFDOUIsQ0FBQztBQUVELFFBQVEsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxNQUF3QjtJQUM5QyxLQUFLLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksTUFBTSxFQUFFO1FBQzNCLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7S0FDakI7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gIFRoaXMgY29kZSBpcyBwb3J0ZWQgZnJvbVxuLy8gIDxodHRwczovL2dpdGh1Yi5jb20vUm9iZXJ0RWxkZXJTb2Z0d2FyZS9yb2JlcnRlbGRlcnNvZnR3YXJlZGlmZi8+XG4vL1xuLy8gIFRoZSBsaWNlbnNlIGZvciB0aGUgb3JpZ2luYWwgY29kZSBpczpcbi8vXG4vLyAgQ29weXJpZ2h0IDIwMTcgUm9iZXJ0IEVsZGVyIFNvZnR3YXJlIEluYy5cbi8vXG4vLyAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vICB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLyAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyAgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8gIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vICBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLyAgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuaW1wb3J0IHJhbmRvbVxuXG5pbXBvcnQgeyB6aXAgfSBmcm9tICcuL3V0aWwnXG5cbmV4cG9ydCBmdW5jdGlvbiBkaWZmPFQsIFU+KFxuICBsZWZ0OiBBcnJheUxpa2U8VD4sXG4gIHJpZ2h0OiBBcnJheUxpa2U8VT4sXG4gIGNvbXBhcmU6ICh0OiBULCB1OiBVKSA9PiBib29sZWFuLFxuICBtYXRjaDogKHBhaXJzOiBJdGVyYWJsZTxbVCwgVV0+KSA9PiB2b2lkLFxuKTogdm9pZCB7XG4gIGNvbnN0IHNsaWNlczogW2FueVtdLCBhbnlbXV1bXSA9IFtdXG4gIGZ1bmN0aW9uIGdvKGU6IEFycmF5PFQ+LCBmOiBBcnJheTxVPiwgaSA9IDAsIGogPSAwKTogdm9pZCB7XG4gICAgLy8gQWRhcHRlZCBmcm9tIGh0dHA6Ly9ibG9nLnJvYmVydGVsZGVyLm9yZy9kaWZmLWFsZ29yaXRobS9cbiAgICAvLyBMaWNlbnNlZCB1bmRlciBBcGFjaGUgMi4wXG4gICAgY29uc3QgW04sIE0sIEwsIFpdID0gW1xuICAgICAgZS5sZW5ndGgsXG4gICAgICBmLmxlbmd0aCxcbiAgICAgIGUubGVuZ3RoICsgZi5sZW5ndGgsXG4gICAgICAyICogTWF0aC5taW4oZS5sZW5ndGgsIGYubGVuZ3RoKSArIDIsXG4gICAgXVxuICAgIGlmIChOID4gMCAmJiBNID4gMCkge1xuICAgICAgY29uc3QgW3csIGcsIHBdID0gW1xuICAgICAgICBOIC0gTSxcbiAgICAgICAgQXJyYXkoWikuZmlsbCgwKSBhcyBudW1iZXJbXSxcbiAgICAgICAgQXJyYXkoWikuZmlsbCgwKSBhcyBudW1iZXJbXSxcbiAgICAgIF1cbiAgICAgIGZvciAobGV0IGggPSAwOyBoIDwgTCAvIDIgKyAoTCAlIDIpICsgMTsgaCsrKSB7XG4gICAgICAgIGZvciAobGV0IHIgPSAwOyByIDwgMjsgcisrKSB7XG4gICAgICAgICAgY29uc3QgW2MsIGQsIG8sIG1dID0gciA9PT0gMCA/IFtnLCBwLCAxLCAxXSA6IFtwLCBnLCAwLCAtMV1cbiAgICAgICAgICBmb3IgKFxuICAgICAgICAgICAgbGV0IGsgPSAtKGggLSAyICogTWF0aC5tYXgoMCwgaCAtIE0pKTtcbiAgICAgICAgICAgIGsgPCBoIC0gMiAqIE1hdGgubWF4KDAsIGggLSBOKSArIDE7XG4gICAgICAgICAgICBrICs9IDJcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIGxldCBhID1cbiAgICAgICAgICAgICAgayA9PT0gLWggfHwgKGsgIT09IGggJiYgY1soayAtIDEpICUgWl0gPCBjWyhrICsgMSkgJSBaXSlcbiAgICAgICAgICAgICAgICA/IGNbKGsgKyAxKSAlIFpdXG4gICAgICAgICAgICAgICAgOiBjWyhrIC0gMSkgJSBaXSArIDFcbiAgICAgICAgICAgIGxldCBiID0gYSAtIGtcbiAgICAgICAgICAgIGNvbnN0IFtzLCB0XSA9IFthLCBiXVxuICAgICAgICAgICAgd2hpbGUgKFxuICAgICAgICAgICAgICBhIDwgTiAmJlxuICAgICAgICAgICAgICBiIDwgTSAmJlxuICAgICAgICAgICAgICBjb21wYXJlKFxuICAgICAgICAgICAgICAgIGVbKDEgLSBvKSAqIE4gKyBtICogYSArIChvIC0gMSldLFxuICAgICAgICAgICAgICAgIGZbKDEgLSBvKSAqIE0gKyBtICogYiArIChvIC0gMSldLFxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgYSsrLCBiKytcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNbayAlIFpdID0gYVxuICAgICAgICAgICAgY29uc3QgeiA9IC0oayAtIHcpXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgIEwgJSAyID09PSBvICYmXG4gICAgICAgICAgICAgIHogPj0gLShoIC0gbykgJiZcbiAgICAgICAgICAgICAgeiA8PSBoIC0gbyAmJlxuICAgICAgICAgICAgICBjW2sgJSBaXSArIGRbeiAlIFpdID49IE5cbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICBjb25zdCBbRCwgeCwgeSwgdSwgdl0gPVxuICAgICAgICAgICAgICAgIG8gPT09IDFcbiAgICAgICAgICAgICAgICAgID8gWzIgKiBoIC0gMSwgcywgdCwgYSwgYl1cbiAgICAgICAgICAgICAgICAgIDogWzIgKiBoLCBOIC0gYSwgTSAtIGIsIE4gLSBzLCBNIC0gdF1cbiAgICAgICAgICAgICAgaWYgKEQgPiAxIHx8ICh4ICE9PSB1ICYmIHkgIT09IHYpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHggIT09IHUgJiYgeSAhPT0gdikge1xuICAgICAgICAgICAgICAgICAgc2xpY2VzLnB1c2goW2Uuc2xpY2UoeCwgdSksIGYuc2xpY2UoeSwgdildKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gZ28oZS5zbGljZSgwLCB4KSwgZi5zbGljZSgwLCB5KSwgaSwgaikuY29uY2F0KFxuICAgICAgICAgICAgICAgIC8vICAgZ28oZS5zbGljZSh1LCBOKSwgZi5zbGljZSh2LCBNKSwgaSArIHUsIGogKyB2KSxcbiAgICAgICAgICAgICAgICBnbyhlLnNsaWNlKDAsIHgpLCBmLnNsaWNlKDAsIHkpLCBpLCBqKVxuICAgICAgICAgICAgICAgIGdvKGUuc2xpY2UodSwgTiksIGYuc2xpY2UodiwgTSksIGkgKyB1LCBqICsgdilcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChNID4gTikge1xuICAgICAgICAgICAgICAgIHNsaWNlcy5wdXNoKFtlLnNsaWNlKDAsIE4pLCBmLnNsaWNlKDAsIE4pXSlcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gZ28oW10sIGYuc2xpY2UoTiwgTSksIGkgKyBOLCBqICsgTilcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChNIDwgTikge1xuICAgICAgICAgICAgICAgIHNsaWNlcy5wdXNoKFtlLnNsaWNlKDAsIE0pLCBmLnNsaWNlKDAsIE0pXSlcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gZ28oZS5zbGljZShNLCBOKSwgW10sIGkgKyBNLCBqICsgTSlcbiAgICAgICAgICAgICAgfSAvLyBlbHNlIHJldHVybiBbXVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gLyogZWxzZSBpZiAoTiA+IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdkZWxldGUnLCBlKVxuICAgICAgcmV0dXJuXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCdpbnNlcnQnLCBlKVxuICAgIH0qL1xuICB9XG4gIGdvKEFycmF5LmZyb20obGVmdCksIEFycmF5LmZyb20ocmlnaHQpKVxuICBtYXRjaChzbGljZXNUb0l0ZW1zKHNsaWNlcykpXG59XG5cbmZ1bmN0aW9uKiBzbGljZXNUb0l0ZW1zKHNsaWNlczogW2FueVtdLCBhbnlbXV1bXSkge1xuICBmb3IgKGNvbnN0IFthLCBiXSBvZiBzbGljZXMpIHtcbiAgICB5aWVsZCogemlwKGEsIGIpXG4gIH1cbn1cbiJdfQ==","export function handlePromise(promise) {\n    if (!promise)\n        return;\n    promise.catch((error) => {\n        console.error(error);\n    });\n}\nimport { lstatSync, existsSync } from 'fs';\nexport function isFileSync(filePath) {\n    if (!existsSync(filePath))\n        return false;\n    return lstatSync(filePath).isFile();\n}\nexport function resolveElement(root, pathToToken) {\n    let element = root;\n    for (const token of pathToToken) {\n        const candidateElement = element\n            .querySelectorAll(`:scope > ${token.tag}`)\n            .item(token.index);\n        if (candidateElement) {\n            element = candidateElement;\n        }\n        else {\n            break;\n        }\n    }\n    if (element === root)\n        return undefined;\n    return element;\n}\nexport function* zip(a, b) {\n    const ita = a[Symbol.iterator]();\n    const itb = b[Symbol.iterator]();\n    let x = ita.next();\n    let y = itb.next();\n    while (!x.done && !y.done) {\n        yield [x.value, y.value];\n        x = ita.next();\n        y = itb.next();\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy1jbGllbnQvdXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLFVBQVUsYUFBYSxDQUFDLE9BQXFCO0lBQ2pELElBQUksQ0FBQyxPQUFPO1FBQUUsT0FBTTtJQUNwQixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBWSxFQUFFLEVBQUU7UUFDN0IsT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUN0QixDQUFDLENBQUMsQ0FBQTtBQUNKLENBQUM7QUFDRCxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLElBQUksQ0FBQTtBQUMxQyxNQUFNLFVBQVUsVUFBVSxDQUFDLFFBQWdCO0lBQ3pDLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDO1FBQUUsT0FBTyxLQUFLLENBQUE7SUFDdkMsT0FBTyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUE7QUFDckMsQ0FBQztBQUVELE1BQU0sVUFBVSxjQUFjLENBQzVCLElBQWEsRUFDYixXQUFrRDtJQUVsRCxJQUFJLE9BQU8sR0FBRyxJQUFJLENBQUE7SUFDbEIsS0FBSyxNQUFNLEtBQUssSUFBSSxXQUFXLEVBQUU7UUFDL0IsTUFBTSxnQkFBZ0IsR0FBdUIsT0FBTzthQUNqRCxnQkFBZ0IsQ0FBQyxZQUFZLEtBQUssQ0FBQyxHQUFHLEVBQUUsQ0FBQzthQUN6QyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBZ0IsQ0FBQTtRQUNuQyxJQUFJLGdCQUFnQixFQUFFO1lBQ3BCLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQTtTQUMzQjthQUFNO1lBQ0wsTUFBSztTQUNOO0tBQ0Y7SUFFRCxJQUFJLE9BQU8sS0FBSyxJQUFJO1FBQUUsT0FBTyxTQUFTLENBQUE7SUFDdEMsT0FBTyxPQUFPLENBQUE7QUFDaEIsQ0FBQztBQUVELE1BQU0sU0FBUyxDQUFDLENBQUMsR0FBRyxDQUNsQixDQUFjLEVBQ2QsQ0FBYztJQUVkLE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQTtJQUNoQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUE7SUFDaEMsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFBO0lBQ2xCLElBQUksQ0FBQyxHQUFHLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtJQUNsQixPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUU7UUFDekIsTUFBTSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFBO1FBQ3hCLENBQUMsR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUE7UUFDZCxDQUFDLEdBQUcsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFBO0tBQ2Y7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZVByb21pc2UocHJvbWlzZTogUHJvbWlzZTxhbnk+KTogdm9pZCB7XG4gIGlmICghcHJvbWlzZSkgcmV0dXJuXG4gIHByb21pc2UuY2F0Y2goKGVycm9yOiBFcnJvcikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gIH0pXG59XG5pbXBvcnQgeyBsc3RhdFN5bmMsIGV4aXN0c1N5bmMgfSBmcm9tICdmcydcbmV4cG9ydCBmdW5jdGlvbiBpc0ZpbGVTeW5jKGZpbGVQYXRoOiBzdHJpbmcpIHtcbiAgaWYgKCFleGlzdHNTeW5jKGZpbGVQYXRoKSkgcmV0dXJuIGZhbHNlXG4gIHJldHVybiBsc3RhdFN5bmMoZmlsZVBhdGgpLmlzRmlsZSgpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlRWxlbWVudChcbiAgcm9vdDogRWxlbWVudCxcbiAgcGF0aFRvVG9rZW46IEFycmF5PHsgdGFnOiBzdHJpbmc7IGluZGV4OiBudW1iZXIgfT4sXG4pOiBFbGVtZW50IHwgdW5kZWZpbmVkIHtcbiAgbGV0IGVsZW1lbnQgPSByb290XG4gIGZvciAoY29uc3QgdG9rZW4gb2YgcGF0aFRvVG9rZW4pIHtcbiAgICBjb25zdCBjYW5kaWRhdGVFbGVtZW50OiBIVE1MRWxlbWVudCB8IG51bGwgPSBlbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvckFsbChgOnNjb3BlID4gJHt0b2tlbi50YWd9YClcbiAgICAgIC5pdGVtKHRva2VuLmluZGV4KSBhcyBIVE1MRWxlbWVudFxuICAgIGlmIChjYW5kaWRhdGVFbGVtZW50KSB7XG4gICAgICBlbGVtZW50ID0gY2FuZGlkYXRlRWxlbWVudFxuICAgIH0gZWxzZSB7XG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIGlmIChlbGVtZW50ID09PSByb290KSByZXR1cm4gdW5kZWZpbmVkIC8vIERvIG5vdCBqdW1wIHRvIHRoZSB0b3Agb2YgdGhlIHByZXZpZXcgZm9yIGJhZCBzeW5jc1xuICByZXR1cm4gZWxlbWVudFxufVxuXG5leHBvcnQgZnVuY3Rpb24qIHppcDxVLCBWPihcbiAgYTogSXRlcmFibGU8VT4sXG4gIGI6IEl0ZXJhYmxlPFY+LFxuKTogSXRlcmFibGVJdGVyYXRvcjxbVSwgVl0+IHtcbiAgY29uc3QgaXRhID0gYVtTeW1ib2wuaXRlcmF0b3JdKClcbiAgY29uc3QgaXRiID0gYltTeW1ib2wuaXRlcmF0b3JdKClcbiAgbGV0IHggPSBpdGEubmV4dCgpXG4gIGxldCB5ID0gaXRiLm5leHQoKVxuICB3aGlsZSAoIXguZG9uZSAmJiAheS5kb25lKSB7XG4gICAgeWllbGQgW3gudmFsdWUsIHkudmFsdWVdXG4gICAgeCA9IGl0YS5uZXh0KClcbiAgICB5ID0gaXRiLm5leHQoKVxuICB9XG59XG4iXX0=","export function processHTMLString(element) {\n    const msvgh = document.getElementById('MathJax_SVG_Hidden');\n    const svgGlyphs = msvgh && msvgh.parentElement;\n    if (svgGlyphs !== null) {\n        return svgGlyphs.outerHTML + element.innerHTML;\n    }\n    else {\n        return element.innerHTML;\n    }\n}\nexport class MathJaxController {\n    constructor(userMacros, mathJaxConfig) {\n        this.userMacros = userMacros;\n        this.mathJaxConfig = mathJaxConfig;\n        this.readyPromise = this.attachMathJax();\n    }\n    static async create(userMacros, mathJaxConfig) {\n        const controller = new MathJaxController(userMacros, mathJaxConfig);\n        await controller.readyPromise;\n        return controller;\n    }\n    dispose() {\n        const script = document.head.querySelector(`script[src='${MathJaxController.mjSrc}']`);\n        if (script)\n            script.remove();\n    }\n    jaxTeXConfig() {\n        return {\n            extensions: this.mathJaxConfig.texExtensions,\n            Macros: this.userMacros,\n            equationNumbers: this.mathJaxConfig.numberEquations\n                ? {\n                    autoNumber: 'AMS',\n                    useLabelIds: false,\n                }\n                : {},\n        };\n    }\n    async queueTypeset(domElement) {\n        const allMath = Array.from(domElement.querySelectorAll('span.math > script[type^=\"math/tex\"]'));\n        const unprocessedMath = allMath.filter((x) => {\n            const jax = MathJax.Hub.getJaxFor(x);\n            return !jax || jax.needsUpdate();\n        });\n        if (unprocessedMath.length === 0)\n            return;\n        return new Promise((resolve) => {\n            if (MathJax.InputJax.TeX) {\n                MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX]);\n            }\n            if (this.mathJaxConfig.numberEquations) {\n                const { temps, spans } = this.setupTemps(allMath);\n                MathJax.Hub.Queue(['PreProcess', MathJax.Hub, temps]);\n                MathJax.Hub.Queue(['Reprocess', MathJax.Hub, temps]);\n                MathJax.Hub.Queue(() => this.cleanupTemps(temps, spans));\n            }\n            else {\n                const { temps, spans } = this.setupTemps(unprocessedMath);\n                MathJax.Hub.Queue(['Update', MathJax.Hub, temps]);\n                MathJax.Hub.Queue(() => this.cleanupTemps(temps, spans));\n            }\n            MathJax.Hub.Queue([resolve]);\n        });\n    }\n    cleanupTemps(temps, spans) {\n        for (const span of spans)\n            span.remove();\n        for (const temp of temps) {\n            temp.style.visibility = '';\n            temp.style.position = '';\n            temp.style.width = '';\n            temp.style.display = '';\n            temp.classList.remove('temp-MathJax');\n        }\n    }\n    setupTemps(scriptElements) {\n        const temps = [];\n        const spans = [];\n        for (const script of scriptElements) {\n            const span = script.parentElement;\n            if (!span)\n                continue;\n            const par = span.parentElement;\n            if (!par)\n                continue;\n            const disp = script.previousElementSibling;\n            if (disp) {\n                const temp = span.cloneNode(false);\n                temp.classList.add('temp-MathJax');\n                temp.appendChild(script.cloneNode(true));\n                temps.push(temp);\n                spans.push(span);\n                par.insertBefore(temp, span);\n                temp.style.visibility = 'hidden';\n                temp.style.position = 'absolute';\n                if (script.type.includes('display')) {\n                    temp.style.width = window.getComputedStyle(disp).width;\n                    temp.style.display = 'block';\n                }\n            }\n            else {\n                temps.push(span);\n            }\n        }\n        return { temps, spans };\n    }\n    async attachMathJax() {\n        await injectScript(MathJaxController.mjSrc);\n        MathJax.Hub.Config({\n            jax: ['input/TeX', `output/${this.mathJaxConfig.latexRenderer}`],\n            extensions: [],\n            TeX: this.jaxTeXConfig(),\n            'HTML-CSS': {\n                availableFonts: [],\n                webFont: 'TeX',\n                imageFont: null,\n                undefinedFamily: this.mathJaxConfig.undefinedFamily,\n                mtextFontInherit: true,\n            },\n            messageStyle: 'none',\n            showMathMenu: false,\n            skipStartupTypeset: true,\n        });\n        MathJax.Hub.Configured();\n    }\n}\nMathJaxController.mjSrc = `${global.require.resolve('mathjax')}?delayStartupUntil=configured`;\nasync function injectScript(scriptSrc) {\n    const script = document.createElement('script');\n    script.src = scriptSrc;\n    script.type = 'text/javascript';\n    document.head.appendChild(script);\n    return new Promise((resolve) => {\n        script.addEventListener('load', () => resolve());\n    });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0aGpheC1oZWxwZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMtY2xpZW50L21hdGhqYXgtaGVscGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQU9BLE1BQU0sVUFBVSxpQkFBaUIsQ0FBQyxPQUFnQjtJQUNoRCxNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLG9CQUFvQixDQUFDLENBQUE7SUFDM0QsTUFBTSxTQUFTLEdBQUcsS0FBSyxJQUFJLEtBQUssQ0FBQyxhQUFhLENBQUE7SUFDOUMsSUFBSSxTQUFTLEtBQUssSUFBSSxFQUFFO1FBQ3RCLE9BQU8sU0FBUyxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFBO0tBQy9DO1NBQU07UUFDTCxPQUFPLE9BQU8sQ0FBQyxTQUFTLENBQUE7S0FDekI7QUFDSCxDQUFDO0FBRUQsTUFBTSxPQUFPLGlCQUFpQjtJQU01QixZQUNVLFVBQWtCLEVBQ2xCLGFBQTRCO1FBRDVCLGVBQVUsR0FBVixVQUFVLENBQVE7UUFDbEIsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFFcEMsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDMUMsQ0FBQztJQUVNLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLFVBQWtCLEVBQUUsYUFBNEI7UUFDekUsTUFBTSxVQUFVLEdBQUcsSUFBSSxpQkFBaUIsQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLENBQUE7UUFDbkUsTUFBTSxVQUFVLENBQUMsWUFBWSxDQUFBO1FBQzdCLE9BQU8sVUFBVSxDQUFBO0lBQ25CLENBQUM7SUFHTSxPQUFPO1FBQ1osTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLElBQUssQ0FBQyxhQUFhLENBQ3pDLGVBQWUsaUJBQWlCLENBQUMsS0FBSyxJQUFJLENBQzNDLENBQUE7UUFDRCxJQUFJLE1BQU07WUFBRSxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUE7SUFD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aUlsQyxLQUFLLFVBQVUsWUFBWSxDQUFDLFNBQWlCO0lBQzNDLE1BQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUE7SUFDL0MsTUFBTSxDQUFDLEdBQUcsR0FBRyxTQUFTLENBQUE7SUFDdEIsTUFBTSxDQUFDLElBQUksR0FBRyxpQkFBaUIsQ0FBQTtJQUMvQixRQUFRLENBQUMsSUFBSyxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtJQUNsQyxPQUFPLElBQUksT0FBTyxDQUFPLENBQUMsT0FBTyxFQUFFLEVBQUU7UUFDbkMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFBO0lBQ2xELENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vXG4vLyBtYXRoamF4LWhlbHBlclxuLy9cbi8vIFRoaXMgbW9kdWxlIHdpbGwgaGFuZGxlIGxvYWRpbmcgdGhlIE1hdGhKYXggZW52aXJvbm1lbnQgYW5kIHByb3ZpZGUgYSB3cmFwcGVyXG4vLyBmb3IgY2FsbHMgdG8gTWF0aEpheCB0byBwcm9jZXNzIExhVGVYIGVxdWF0aW9ucy5cbi8vXG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9jZXNzSFRNTFN0cmluZyhlbGVtZW50OiBFbGVtZW50KSB7XG4gIGNvbnN0IG1zdmdoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ01hdGhKYXhfU1ZHX0hpZGRlbicpXG4gIGNvbnN0IHN2Z0dseXBocyA9IG1zdmdoICYmIG1zdmdoLnBhcmVudEVsZW1lbnRcbiAgaWYgKHN2Z0dseXBocyAhPT0gbnVsbCkge1xuICAgIHJldHVybiBzdmdHbHlwaHMub3V0ZXJIVE1MICsgZWxlbWVudC5pbm5lckhUTUxcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZWxlbWVudC5pbm5lckhUTUxcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTWF0aEpheENvbnRyb2xsZXIge1xuICBwcml2YXRlIHN0YXRpYyBtalNyYyA9IGAke2dsb2JhbC5yZXF1aXJlLnJlc29sdmUoXG4gICAgJ21hdGhqYXgnLFxuICApfT9kZWxheVN0YXJ0dXBVbnRpbD1jb25maWd1cmVkYFxuICBwcml2YXRlIHJlYWRvbmx5IHJlYWR5UHJvbWlzZTogUHJvbWlzZTx2b2lkPlxuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSB1c2VyTWFjcm9zOiBvYmplY3QsXG4gICAgcHJpdmF0ZSBtYXRoSmF4Q29uZmlnOiBNYXRoSmF4Q29uZmlnLFxuICApIHtcbiAgICB0aGlzLnJlYWR5UHJvbWlzZSA9IHRoaXMuYXR0YWNoTWF0aEpheCgpXG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGFzeW5jIGNyZWF0ZSh1c2VyTWFjcm9zOiBvYmplY3QsIG1hdGhKYXhDb25maWc6IE1hdGhKYXhDb25maWcpIHtcbiAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IE1hdGhKYXhDb250cm9sbGVyKHVzZXJNYWNyb3MsIG1hdGhKYXhDb25maWcpXG4gICAgYXdhaXQgY29udHJvbGxlci5yZWFkeVByb21pc2VcbiAgICByZXR1cm4gY29udHJvbGxlclxuICB9XG5cbiAgLy8gZm9yIHRlc3RpbmdcbiAgcHVibGljIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuaGVhZCEucXVlcnlTZWxlY3RvcihcbiAgICAgIGBzY3JpcHRbc3JjPScke01hdGhKYXhDb250cm9sbGVyLm1qU3JjfSddYCxcbiAgICApXG4gICAgaWYgKHNjcmlwdCkgc2NyaXB0LnJlbW92ZSgpXG4gIH1cblxuICBwdWJsaWMgamF4VGVYQ29uZmlnKCkge1xuICAgIHJldHVybiB7XG4gICAgICBleHRlbnNpb25zOiB0aGlzLm1hdGhKYXhDb25maWcudGV4RXh0ZW5zaW9ucyxcbiAgICAgIE1hY3JvczogdGhpcy51c2VyTWFjcm9zLFxuICAgICAgZXF1YXRpb25OdW1iZXJzOiB0aGlzLm1hdGhKYXhDb25maWcubnVtYmVyRXF1YXRpb25zXG4gICAgICAgID8ge1xuICAgICAgICAgICAgYXV0b051bWJlcjogJ0FNUycsXG4gICAgICAgICAgICB1c2VMYWJlbElkczogZmFsc2UsXG4gICAgICAgICAgfVxuICAgICAgICA6IHt9LFxuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBxdWV1ZVR5cGVzZXQoZG9tRWxlbWVudDogRWxlbWVudCkge1xuICAgIGNvbnN0IGFsbE1hdGggPSBBcnJheS5mcm9tKFxuICAgICAgZG9tRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuLm1hdGggPiBzY3JpcHRbdHlwZV49XCJtYXRoL3RleFwiXScpLFxuICAgIClcbiAgICBjb25zdCB1bnByb2Nlc3NlZE1hdGggPSBhbGxNYXRoLmZpbHRlcigoeCkgPT4ge1xuICAgICAgY29uc3QgamF4ID0gTWF0aEpheC5IdWIuZ2V0SmF4Rm9yKHgpIGFzIE1hdGhKYXguRWxlbWVudEpheCB8IG51bGxcbiAgICAgIHJldHVybiAhamF4IHx8IGpheC5uZWVkc1VwZGF0ZSgpXG4gICAgfSlcbiAgICBpZiAodW5wcm9jZXNzZWRNYXRoLmxlbmd0aCA9PT0gMCkgcmV0dXJuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XG4gICAgICBpZiAoTWF0aEpheC5JbnB1dEpheC5UZVgpIHtcbiAgICAgICAgTWF0aEpheC5IdWIuUXVldWUoWydyZXNldEVxdWF0aW9uTnVtYmVycycsIE1hdGhKYXguSW5wdXRKYXguVGVYXSlcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm1hdGhKYXhDb25maWcubnVtYmVyRXF1YXRpb25zKSB7XG4gICAgICAgIGNvbnN0IHsgdGVtcHMsIHNwYW5zIH0gPSB0aGlzLnNldHVwVGVtcHMoYWxsTWF0aClcbiAgICAgICAgTWF0aEpheC5IdWIuUXVldWUoWydQcmVQcm9jZXNzJywgTWF0aEpheC5IdWIsIHRlbXBzXSlcbiAgICAgICAgTWF0aEpheC5IdWIuUXVldWUoWydSZXByb2Nlc3MnLCBNYXRoSmF4Lkh1YiwgdGVtcHNdKVxuICAgICAgICBNYXRoSmF4Lkh1Yi5RdWV1ZSgoKSA9PiB0aGlzLmNsZWFudXBUZW1wcyh0ZW1wcywgc3BhbnMpKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgeyB0ZW1wcywgc3BhbnMgfSA9IHRoaXMuc2V0dXBUZW1wcyh1bnByb2Nlc3NlZE1hdGgpXG4gICAgICAgIE1hdGhKYXguSHViLlF1ZXVlKFsnVXBkYXRlJywgTWF0aEpheC5IdWIsIHRlbXBzXSlcbiAgICAgICAgTWF0aEpheC5IdWIuUXVldWUoKCkgPT4gdGhpcy5jbGVhbnVwVGVtcHModGVtcHMsIHNwYW5zKSlcbiAgICAgIH1cbiAgICAgIE1hdGhKYXguSHViLlF1ZXVlKFtyZXNvbHZlXSlcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBjbGVhbnVwVGVtcHModGVtcHM6IEhUTUxFbGVtZW50W10sIHNwYW5zOiBIVE1MRWxlbWVudFtdKSB7XG4gICAgZm9yIChjb25zdCBzcGFuIG9mIHNwYW5zKSBzcGFuLnJlbW92ZSgpXG4gICAgZm9yIChjb25zdCB0ZW1wIG9mIHRlbXBzKSB7XG4gICAgICB0ZW1wLnN0eWxlLnZpc2liaWxpdHkgPSAnJ1xuICAgICAgdGVtcC5zdHlsZS5wb3NpdGlvbiA9ICcnXG4gICAgICB0ZW1wLnN0eWxlLndpZHRoID0gJydcbiAgICAgIHRlbXAuc3R5bGUuZGlzcGxheSA9ICcnXG4gICAgICB0ZW1wLmNsYXNzTGlzdC5yZW1vdmUoJ3RlbXAtTWF0aEpheCcpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzZXR1cFRlbXBzKHNjcmlwdEVsZW1lbnRzOiBFbGVtZW50W10pIHtcbiAgICBjb25zdCB0ZW1wczogSFRNTEVsZW1lbnRbXSA9IFtdXG4gICAgY29uc3Qgc3BhbnM6IEhUTUxFbGVtZW50W10gPSBbXVxuICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIHNjcmlwdEVsZW1lbnRzKSB7XG4gICAgICBjb25zdCBzcGFuID0gc2NyaXB0LnBhcmVudEVsZW1lbnRcbiAgICAgIGlmICghc3BhbikgY29udGludWVcbiAgICAgIGNvbnN0IHBhciA9IHNwYW4ucGFyZW50RWxlbWVudFxuICAgICAgaWYgKCFwYXIpIGNvbnRpbnVlXG4gICAgICBjb25zdCBkaXNwID0gc2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmdcbiAgICAgIGlmIChkaXNwKSB7XG4gICAgICAgIC8vIHVwZGF0ZSByZW5kZXJcbiAgICAgICAgY29uc3QgdGVtcCA9IHNwYW4uY2xvbmVOb2RlKGZhbHNlKSBhcyBIVE1MU3BhbkVsZW1lbnRcbiAgICAgICAgdGVtcC5jbGFzc0xpc3QuYWRkKCd0ZW1wLU1hdGhKYXgnKVxuICAgICAgICB0ZW1wLmFwcGVuZENoaWxkKHNjcmlwdC5jbG9uZU5vZGUodHJ1ZSkpXG4gICAgICAgIHRlbXBzLnB1c2godGVtcClcbiAgICAgICAgc3BhbnMucHVzaChzcGFuKVxuICAgICAgICBwYXIuaW5zZXJ0QmVmb3JlKHRlbXAsIHNwYW4pXG4gICAgICAgIHRlbXAuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nXG4gICAgICAgIHRlbXAuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnXG4gICAgICAgIGlmICgoc2NyaXB0IGFzIEhUTUxTY3JpcHRFbGVtZW50KS50eXBlLmluY2x1ZGVzKCdkaXNwbGF5JykpIHtcbiAgICAgICAgICB0ZW1wLnN0eWxlLndpZHRoID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZGlzcCkud2lkdGhcbiAgICAgICAgICB0ZW1wLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGluaXRpYWwgcmVuZGVyXG4gICAgICAgIHRlbXBzLnB1c2goc3BhbilcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHsgdGVtcHMsIHNwYW5zIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYXR0YWNoTWF0aEpheCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBBdHRhY2ggTWF0aEpheCBzY3JpcHRcbiAgICBhd2FpdCBpbmplY3RTY3JpcHQoTWF0aEpheENvbnRyb2xsZXIubWpTcmMpXG5cbiAgICBNYXRoSmF4Lkh1Yi5Db25maWcoe1xuICAgICAgamF4OiBbJ2lucHV0L1RlWCcsIGBvdXRwdXQvJHt0aGlzLm1hdGhKYXhDb25maWcubGF0ZXhSZW5kZXJlcn1gXSxcbiAgICAgIGV4dGVuc2lvbnM6IFtdLFxuICAgICAgVGVYOiB0aGlzLmpheFRlWENvbmZpZygpLFxuICAgICAgJ0hUTUwtQ1NTJzoge1xuICAgICAgICBhdmFpbGFibGVGb250czogW10sXG4gICAgICAgIHdlYkZvbnQ6ICdUZVgnLFxuICAgICAgICBpbWFnZUZvbnQ6IG51bGwgYXMgYW55LCAvLyBUT0RPOiBjb21wbGFpbiBvbiBEVFxuICAgICAgICB1bmRlZmluZWRGYW1pbHk6IHRoaXMubWF0aEpheENvbmZpZy51bmRlZmluZWRGYW1pbHkgYXMgYW55LCAvLyBUT0RPOiBjb21wbGFpbiBvbiBEVFxuICAgICAgICBtdGV4dEZvbnRJbmhlcml0OiB0cnVlLFxuICAgICAgfSxcbiAgICAgIG1lc3NhZ2VTdHlsZTogJ25vbmUnLFxuICAgICAgc2hvd01hdGhNZW51OiBmYWxzZSxcbiAgICAgIHNraXBTdGFydHVwVHlwZXNldDogdHJ1ZSxcbiAgICB9KVxuICAgIE1hdGhKYXguSHViLkNvbmZpZ3VyZWQoKVxuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGluamVjdFNjcmlwdChzY3JpcHRTcmM6IHN0cmluZykge1xuICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKVxuICBzY3JpcHQuc3JjID0gc2NyaXB0U3JjXG4gIHNjcmlwdC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCdcbiAgZG9jdW1lbnQuaGVhZCEuYXBwZW5kQ2hpbGQoc2NyaXB0KVxuICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUpID0+IHtcbiAgICBzY3JpcHQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHJlc29sdmUoKSlcbiAgfSlcbn1cbiJdfQ==","export function getMedia(document) {\n    return document.querySelectorAll('img[src],audio[src],video[src],link[href]');\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC1jb21tb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbC1jb21tb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxVQUFVLFFBQVEsQ0FBQyxRQUFzQjtJQUM3QyxPQUFPLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FDOUIsMkNBQTJDLENBRzVDLENBQUE7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGdldE1lZGlhKGRvY3VtZW50OiBIVE1MRG9jdW1lbnQpIHtcbiAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgJ2ltZ1tzcmNdLGF1ZGlvW3NyY10sdmlkZW9bc3JjXSxsaW5rW2hyZWZdJyxcbiAgKSBhcyBOb2RlTGlzdE9mPFxuICAgIEhUTUxJbWFnZUVsZW1lbnQgfCBIVE1MQXVkaW9FbGVtZW50IHwgSFRNTFZpZGVvRWxlbWVudCB8IEhUTUxMaW5rRWxlbWVudFxuICA+XG59XG4iXX0="],"names":["$parcel$global","globalThis","self","window","global","$cecc57bd705d34a3f46722639be3a1$var$_electron","_electron","async","oldDom","newDom","opts","idMap","WeakMap","diffMethod","time","idx","matchEls","newRoot","oldRoot","newEl","firstChild","oldEl","newCount","childNodes","length","oldCount","isEqual","nodeType","Node","ELEMENT_NODE","sidx","toString","set","nextSibling","runHeuristic","a","Array","from","allChildren","b","ncomp","$ffc091febcb582b621f5f704c33db6af$exports","diff","pairs","x","y","console","log","$c9e2da52b16bd8155d72173b7e42f$var$_morphdom","default","childrenOnly","onBeforeElUpdated","fromEl","toEl","isEqualNode","tcs","getMathContents","textContent","getNodeKey","node","get","e","error","innerHTML","renderLaTeX","mjController","queueTypeset","Object","defineProperty","value","range","doc","document","undefined","HAS_TEMPLATE_SUPPORT","createElement","HAS_RANGE_SUPPORT","createRange","toElement","str","trim","template","content","createFragmentFromTemplate","selectNode","body","createContextualFragment","createFragmentFromRange","fragment","createFragmentFromWrap","compareNodeNames","fromCodeStart","toCodeStart","fromNodeName","nodeName","toNodeName","charCodeAt","toUpperCase","syncBooleanAttrProp","name","setAttribute","removeAttribute","specialElHandlers","OPTION","parentNode","parentName","hasAttribute","selected","selectedIndex","INPUT","TEXTAREA","newValue","oldValue","nodeValue","placeholder","SELECT","optgroup","i","curChild","noop","defaultGetNodeKey","getAttribute","id","morphAttrs","morphdom","fromNode","toNode","attr","attrName","attrNamespaceURI","attrValue","toNodeAttrs","attributes","namespaceURI","localName","getAttributeNS","prefix","setAttributeNS","fromNodeAttrs","d","hasAttributeNS","removeAttributeNS","options","toNodeHtml","onBeforeNodeAdded","onNodeAdded","onElUpdated","onBeforeNodeDiscarded","onNodeDiscarded","onBeforeElChildrenUpdated","fromNodesLookup","create","keyedRemovalList","addKeyedRemoval","key","push","removeNode","skipKeyedNodes","removeChild","walkDiscardedChildNodes","handleNodeAdded","el","unmatchedFromEl","replaceChild","morphEl","toElKey","curToNodeKey","curFromNodeKey","fromNextSibling","toNextSibling","matchingFromEl","curToNodeChild","curFromNodeChild","outer","isSameNode","curFromNodeType","isCompatible","insertBefore","appendChild","onBeforeNodeAddedResult","actualize","ownerDocument","cleanupFromEl","specialElHandler","morphChildren","indexTree","morphedNode","morphedNodeType","toNodeType","nextChild","moveChildren","createElementNS","len","elToRemove","$e730ac64d1f01aff290702b7ff3c8beb$exports","left","right","compare","match","slices","go","f","j","N","M","L","Z","Math","min","w","g","p","fill","h","r","c","o","m","k","max","s","t","z","D","u","v","slice","$a137d74b5d1f961e65402b2544f0d7a$exports","zip","slicesToItems","promise","catch","filePath","$a137d74b5d1f961e65402b2544f0d7a$var$_fs","existsSync","lstatSync","isFile","root","pathToToken","element","token","candidateElement","querySelectorAll","tag","item","index","ita","Symbol","iterator","itb","next","done","_fs","isElement","tagName","classList","contains","ascr","querySelector","bscr","type","isEqualMath","ac","bc","DOCUMENT_TYPE_NODE","publicId","systemId","checkDocumentType","every","getNamedItemNS","checkElement","ATTRIBUTE_NODE","checkAttr","PROCESSING_INSTRUCTION_NODE","target","data","checkProcInstr","TEXT_NODE","COMMENT_NODE","checkData","children","cb","start","performance","now","res","msvgh","getElementById","svgGlyphs","parentElement","outerHTML","MathJaxController","constructor","userMacros","mathJaxConfig","this","readyPromise","attachMathJax","[object Object]","controller","dispose","script","head","mjSrc","remove","jaxTeXConfig","extensions","texExtensions","Macros","equationNumbers","numberEquations","autoNumber","useLabelIds","domElement","allMath","unprocessedMath","filter","jax","MathJax","Hub","getJaxFor","needsUpdate","Promise","resolve","InputJax","TeX","Queue","temps","spans","setupTemps","cleanupTemps","span","temp","style","visibility","position","width","display","scriptElements","par","disp","previousElementSibling","cloneNode","add","includes","getComputedStyle","scriptSrc","src","addEventListener","injectScript","Config","latexRenderer","HTML-CSS","availableFonts","webFont","imageFont","undefinedFamily","mtextFontInherit","messageStyle","showMathMenu","skipStartupTypeset","Configured","require","$cecc57bd705d34a3f46722639be3a1$var$util","$cecc57bd705d34a3f46722639be3a1$var$_interopRequireWildcard","handlerId","nativePageScrollKeys","uncaughtError","err","ipcRenderer","send","message","stack","evt","reason","atomVars","mathJax","resFn","mkResPromise","sourceLineMap","Map","revSourceMap","scrollSync","firstLine","lastLine","scroll","top","slm","lines","keys","sort","lowix","findIndex","highix","low","high","norm","meanScroll","entries","line","weight","getBoundingClientRect","documentElement","scrollTop","clientHeight","updatePromise","nextUpdateParams","doUpdate","html","map","scrollSyncParams","preview","domDocument","DOMParser","parseFromString","hasChildNodes","container","headElement","visibleElements","innerHeight","bottom","$c9e2da52b16bd8155d72173b7e42f$exports","update","stillVisibleElements","offsetParent","lastEl","scrollBy","slsm","rsm","lineS","path","parseInt","elem","util","resolveElement","rsmel","request","result","$fae90f0a73bce816af5ed733fe$exports","processHTMLString","delayedUpdate","then","on","_evt","params","dataset","markdownPreviewPlusContext","context","setProperty","pdfExportOptions","val","_event","styles","styleElem","join","oldsrc","imgs","$e5233bf2e340b87217b858bda672f7a$exports","getMedia","img","ovs","ov","flash","scrollIntoViewIfNeeded","setTimeout","readyState","loaded","removeEventListener","baseElement","keyEventHandler","altKey","ctrlKey","shiftKey","metaKey","code","bubbles","cancelable","composed","detail","isComposing","location","repeat","preventDefault","lastContextMenuTarget","href","msg","errorDiv","event","deltaY","stopPropagation","height","visible","_line","_elem","bind","_","onbeforeunload","selection","getSelection","selectedText","selectedNode","anchorNode","startsWith","anchor","decodeURIComponent","scrollIntoView"],"version":3,"file":"main.js.map"}